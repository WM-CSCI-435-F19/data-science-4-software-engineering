---

title: Conventional Preprocessing

keywords: fastai
sidebar: home_sidebar

summary: "This module comprises preprocessing techniques applied to software artifacts (TODO:cite here the papers employed for this preprocessings):"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/0.1_mgmnt.prep.conv.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#! pip install dit</span>
<span class="c1">#! pip install nltk</span>
<span class="c1">#! pip install tokenizers</span>
<span class="c1">#! pip install tensorflow_datasets</span>
<span class="o">!</span> pip install -U tensorflow-gpu
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> pip install tensorflow_datasets
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nltk.stem.snowball</span> <span class="kn">import</span> <span class="n">SnowballStemmer</span>
<span class="n">englishStemmer</span><span class="o">=</span><span class="n">SnowballStemmer</span><span class="p">(</span><span class="s2">&quot;english&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="ch">#! pip install nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> unzip -qq cisco/CSB-CICDPipelineEdition-master.zip
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setup">Setup<a class="anchor-link" href="#Setup">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">libest_params</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;libest&#39;</span><span class="p">,</span>
        <span class="c1">#&#39;path_zip&#39;: Path(&quot;cisco/sacp-python-common.zip&quot;),</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/libest_data&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="n">path_data</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span>
        <span class="c1">#&#39;model_prefix&#39;: path_data+&#39;models/bpe/sentencepiece/wiki_py_java_bpe_128k&#39; #For BPE Analysis</span>
        <span class="c1">#&#39;model_prefix&#39;: path_data+&#39;models/bpe/sentencepiece/wiki_py_java_bpe_32k&#39;</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_prefix</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;bpe8k&#39;</span> <span class="p">:</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bpe32k&#39;</span> <span class="p">:</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_32k&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bpe128k&#39;</span> <span class="p">:</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_128k&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#params = default_params()</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">libest_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conventional-Preprocessing-Class">Conventional Preprocessing Class<a class="anchor-link" href="#Conventional-Preprocessing-Class">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ConventionalPreprocessing" class="doc_header"><code>class</code> <code>ConventionalPreprocessing</code><a href="ds4se/mgmnt/prep/conv.py#L41" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ConventionalPreprocessing</code>(<strong><code>params</code></strong>, <strong><code>bpe</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>NLTK libraries for Conventional Preprocessing</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="open_file" class="doc_header"><code>open_file</code><a href="ds4se/mgmnt/prep/conv.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>open_file</code>(<strong><code>f</code></strong>, <strong><code>encoding</code></strong>=<em><code>'utf-8'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="ds4se/mgmnt/prep/conv.py#L179" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>system</code></strong>, <strong><code>ends</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="1.-Processing-Software-Corpora-from-GitHub">1. Processing Software Corpora from GitHub<a class="anchor-link" href="#1.-Processing-Software-Corpora-from-GitHub">&#182;</a></h2><blockquote><p>Cisco Repositories</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;cisco/CSB-CICDPipelineEdition-master/&quot;</span><span class="p">)</span>
<span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">sacp_params</span><span class="p">()</span>
<span class="n">params</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;system&#39;: &#39;sacp-python-common&#39;,
 &#39;path_zip&#39;: PosixPath(&#39;tf/data/cisco/sacp_data/sacp-python-common.zip&#39;),
 &#39;dataset&#39;: &#39;tf/data/cisco/sacp_data/&#39;,
 &#39;saving_path&#39;: &#39;../../data/cisco/sacp_data/&#39;,
 &#39;language&#39;: &#39;english&#39;,
 &#39;model_prefix&#39;: &#39;../dvc-ds4se/models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prep</span> <span class="o">=</span> <span class="n">ConventionalPreprocessing</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">bpe</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">########################################################</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#explore</span>
<span class="n">archive</span> <span class="o">=</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;cisco/sacp-python-common.zip&quot;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">archive</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#explore</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">)]</span> <span class="c1">#recursively finds files</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_file_zip" class="doc_header"><code>get_file_zip</code><a href="ds4se/mgmnt/prep/conv.py#L186" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_file_zip</code>(<strong><code>params</code></strong>, <strong><code>ends</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#tst</span>
<span class="n">df_sampling</span> <span class="o">=</span> <span class="n">get_file_zip</span><span class="p">(</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span><span class="p">,</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#tst</span>
<span class="n">df_sampling</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#tst</span>
<span class="n">prep</span><span class="o">.</span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">df_sampling</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;py&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#tst</span>
<span class="n">df_sampling</span> <span class="o">=</span> <span class="n">prep</span><span class="o">.</span><span class="n">LoadCorpus</span><span class="p">(</span><span class="mf">1595859280.080238</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;py&#39;</span><span class="p">)</span>
<span class="n">df_sampling</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Creating-standard-dataframe-for-issues-and-pull-request-(cisco)">Creating standard dataframe for issues and pull-request (cisco)<a class="anchor-link" href="#Creating-standard-dataframe-for-issues-and-pull-request-(cisco)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;cisco/sacp-pullrequest-01.csv&#39;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;~&#39;</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_data</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Merging all the system artifacts in one file</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_sys</span> <span class="o">=</span> <span class="n">pr_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pr_all_sys</span> <span class="o">=</span> <span class="n">pr_all_sys</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;body&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="c1">#merging tree columns for the text</span>
<span class="n">pr_all_sys</span> <span class="o">=</span> <span class="n">pr_all_sys</span><span class="p">[[</span><span class="s1">&#39;id-pr&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span>
<span class="n">pr_all_sys</span> <span class="o">=</span> <span class="n">pr_all_sys</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id-pr&#39;</span><span class="p">:</span> <span class="s1">&#39;ids&#39;</span><span class="p">})</span>
<span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;pr&#39;</span> <span class="c1">#&lt;------- File Type Standard for Target or Source</span>
<span class="n">pr_all_sys</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_code</span> <span class="o">=</span> <span class="n">df_sampling</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1">#pr_all_code[&#39;text&#39;] =  pr_all_code.apply(lambda row: row[&#39;content&#39;].decode(&quot;utf-8&quot;), axis = 1)</span>
<span class="n">pr_all_code</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pr_all_code</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">eval</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">pr_all_code</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">pr_all_code</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="n">pr_all_code</span> <span class="o">=</span> <span class="n">pr_all_code</span><span class="p">[[</span><span class="s1">&#39;names&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]]</span>
<span class="n">pr_all_code</span> <span class="o">=</span> <span class="n">pr_all_code</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;names&#39;</span><span class="p">:</span> <span class="s1">&#39;ids&#39;</span><span class="p">})</span>
<span class="n">pr_all_code</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;py&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_sys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pr_all_sys</span><span class="p">,</span> <span class="n">pr_all_code</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;conv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prep</span><span class="o">.</span><span class="n">fromdocs_pipeline</span><span class="p">(</span> <span class="n">pr_all_sys</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span> <span class="c1">#Conventional Preprocessing</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pr_all_sys</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prep</span><span class="o">.</span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">pr_all_sys</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;all-corpus&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Loading for Preprocessing</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sacp</span> <span class="o">=</span> <span class="n">prep</span><span class="o">.</span><span class="n">LoadCorpus</span><span class="p">(</span><span class="mf">1595953540.866044</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;all-corpus&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sacp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ids</th>
      <th>text</th>
      <th>type</th>
      <th>conv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>295</td>
      <td>Production Merge * Feed release name through t...</td>
      <td>pr</td>
      <td>product merg feed releas name upload bom allow...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>294</td>
      <td>Add test fields for DARE push * Added test dat...</td>
      <td>pr</td>
      <td>add test field dare push test data json sent d...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>293</td>
      <td>Allow passing a release to uploadBom by name, ...</td>
      <td>pr</td>
      <td>allow pass releas upload bom name rather chang...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>287</td>
      <td>Allow append images #363 - Changed how image n...</td>
      <td>pr</td>
      <td>allow append imag chang imag name creat send c...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>274</td>
      <td>Move docker/blackduck test to slave 4</td>
      <td>pr</td>
      <td>move docker blackduck test slave</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sacp</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span> <span class="p">)</span> <span class="c1">#empty files are not considered</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Iterating All Possible BPEs configs</span>
<span class="k">for</span> <span class="n">bpe</span> <span class="ow">in</span> <span class="n">model_prefix</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">mpr</span> <span class="o">=</span> <span class="n">model_prefix</span><span class="p">[</span><span class="n">bpe</span><span class="p">]</span>
    <span class="n">prep</span> <span class="o">=</span> <span class="n">ConventionalPreprocessing</span><span class="p">(</span><span class="n">sacp_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">mpr</span><span class="p">),</span> <span class="n">bpe</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">df_sacp</span><span class="p">[</span><span class="n">bpe</span><span class="p">]</span> <span class="o">=</span> <span class="n">prep</span><span class="o">.</span><span class="n">bpe_pieces_pipeline</span><span class="p">(</span> <span class="n">df_sacp</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="p">)</span> <span class="c1">#BPE Preprocessing</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sacp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ids</th>
      <th>text</th>
      <th>type</th>
      <th>conv</th>
      <th>bpe8k</th>
      <th>bpe32k</th>
      <th>bpe128k</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>295</td>
      <td>Production Merge * Feed release name through t...</td>
      <td>pr</td>
      <td>product merg feed releas name upload bom allow...</td>
      <td>[▁production, ▁mer, ge, ▁*, ▁feed, ▁release, ▁...</td>
      <td>[▁production, ▁merge, ▁*, ▁feed, ▁release, ▁na...</td>
      <td>[▁production, ▁merge, ▁*, ▁feed, ▁release, ▁na...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>294</td>
      <td>Add test fields for DARE push * Added test dat...</td>
      <td>pr</td>
      <td>add test field dare push test data json sent d...</td>
      <td>[▁add, ▁test, ▁fields, ▁for, ▁d, are, ▁p, ush,...</td>
      <td>[▁add, ▁test, ▁fields, ▁for, ▁dare, ▁push, ▁*,...</td>
      <td>[▁add, ▁test, ▁fields, ▁for, ▁dare, ▁push, ▁*,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>293</td>
      <td>Allow passing a release to uploadBom by name, ...</td>
      <td>pr</td>
      <td>allow pass releas upload bom name rather chang...</td>
      <td>[▁allow, ▁passing, ▁a, ▁release, ▁to, ▁up, loa...</td>
      <td>[▁allow, ▁passing, ▁a, ▁release, ▁to, ▁up, loa...</td>
      <td>[▁allow, ▁passing, ▁a, ▁release, ▁to, ▁upload,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>287</td>
      <td>Allow append images #363 - Changed how image n...</td>
      <td>pr</td>
      <td>allow append imag chang imag name creat send c...</td>
      <td>[▁allow, ▁app, end, ▁images, ▁#, 3, 63, ▁-, ▁c...</td>
      <td>[▁allow, ▁append, ▁images, ▁#3, 63, ▁-, ▁chang...</td>
      <td>[▁allow, ▁append, ▁images, ▁#3, 63, ▁-, ▁chang...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>274</td>
      <td>Move docker/blackduck test to slave 4</td>
      <td>pr</td>
      <td>move docker blackduck test slave</td>
      <td>[▁move, ▁d, ock, er, /, black, d, uck, ▁test, ...</td>
      <td>[▁move, ▁dock, er, /, black, d, uck, ▁test, ▁t...</td>
      <td>[▁move, ▁docker, /, black, duck, ▁test, ▁to, ▁...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prep</span><span class="o">.</span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">df_sacp</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;all-corpus&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2020-12-29 06:52:58,801 : INFO : Saving in...../../data/cisco/sacp_data/[sacp-python-common-all-corpus-1609224778.517111].csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>old code down [becareful]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#debugging</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;cisco/CSB-CICDPipelineEdition-master/&quot;</span><span class="p">)</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">path</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*.py&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">temp_list</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_java</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">system</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">],</span> <span class="n">ends</span><span class="o">=</span><span class="s1">&#39;.py&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_java</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_java</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">df_java</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;py&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">LoadCorpus</span><span class="p">(</span><span class="mf">1592266849.29903</span><span class="p">,</span><span class="n">language</span><span class="o">=</span><span class="s1">&#39;py&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-Processing-Software-Corpora-from-CodeSearchNet">2. Processing Software Corpora from CodeSearchNet<a class="anchor-link" href="#2.-Processing-Software-Corpora-from-CodeSearchNet">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#CodeSearchNet Parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;system&#39;</span><span class="p">:</span><span class="s1">&#39;codesearchnet&#39;</span><span class="p">,</span>
    <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="s1">&#39;test_data/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#[step1] Create Preprocesser &lt;----------</span>
<span class="n">preprocess_pipeline</span> <span class="o">=</span> <span class="n">ConventionalPreprocessing</span><span class="p">(</span><span class="n">params</span><span class="o">=</span> <span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">python_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;codesearch/python/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*.gz&#39;</span><span class="p">))</span>
<span class="n">java_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;codesearch/java/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*.gz&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_files</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_long_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;repo&#39;</span><span class="p">,</span> <span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;code_tokens&#39;</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">,</span> <span class="s1">&#39;docstring_tokens&#39;</span><span class="p">,</span> 
                     <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">]</span>

<span class="n">columns_short_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;code_tokens&#39;</span><span class="p">,</span> <span class="s1">&#39;docstring_tokens&#39;</span><span class="p">,</span> 
                      <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;partition&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">jsonl_list_to_dataframe</span><span class="p">(</span><span class="n">file_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns_long_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Load a list of jsonl.gz files into a pandas DataFrame.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> 
                                   <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">,</span> 
                                   <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
                                   <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="n">columns</span><span class="p">]</span> 
                      <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">],</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">python_searchnet_df</span> <span class="o">=</span> <span class="n">jsonl_list_to_dataframe</span><span class="p">(</span><span class="n">python_files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span> <span class="o">=</span> <span class="n">jsonl_list_to_dataframe</span><span class="p">(</span><span class="n">java_files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pytrain</span> <span class="o">=</span> <span class="n">java_searchnet_df</span><span class="p">[</span><span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">partition</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">javatrain</span> <span class="o">=</span> <span class="n">java_searchnet_df</span><span class="p">[</span><span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">partition</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pytrain</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">javatrain</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">javatrain</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;java&#39;</span><span class="p">)</span> <span class="c1">#Saving codesearchnet only training samples</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Testing-Preprocessing-for-CodeSearchNet">Testing Preprocessing for CodeSearchNet<a class="anchor-link" href="#Testing-Preprocessing-for-CodeSearchNet">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span> <span class="o">=</span> <span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">LoadCorpus</span><span class="p">(</span><span class="mf">1592409554.097457</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;java&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">java_searchnet_df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preprocessed_df</span> <span class="o">=</span> <span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">fromdocs_pipeline</span><span class="p">(</span><span class="n">java_searchnet_df</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preprocessed_df</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_preprocessed</span> <span class="o">=</span> <span class="n">java_searchnet_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_preprocessed</span><span class="p">[</span><span class="s1">&#39;preprocessed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">preprocessed_df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_preprocessed</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">df_preprocessed</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;preprocessed-java&#39;</span><span class="p">)</span> <span class="c1">#Saving codesearchnet</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3.-Processing-from-Wikipedia">3. Processing from Wikipedia<a class="anchor-link" href="#3.-Processing-from-Wikipedia">&#182;</a></h1><blockquote><p>Inspired by <a href="https: //www.kdnuggets.com/2017/11/building-wikipedia-text-corpus-nlp.html">KD</a>&gt; &gt;Dump Wiki File <a href="https: //dumps.wikimedia.org/enwiki/latest/">here</a></p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Config description: Wikipedia dataset for en, parsed from 20190301 dump.</span>
<span class="c1">#Download size: 15.72 GiB</span>
<span class="c1">#Dataset size: Unknown size</span>
<span class="c1">#Examples: train 5,824596</span>
<span class="n">dataset_name</span> <span class="o">=</span> <span class="s1">&#39;wikipedia/20200301.en&#39;</span> <span class="c1">#&#39;wikipedia/20190301.en&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Download the dataset and create a tf.data.Dataset</span>
<span class="n">ds</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">tfds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">with_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Accessing Metadata with DatasetInfo</span>
<span class="nb">print</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">splits</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num_examples</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">info</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset_wiki</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#dataset_wiki = ds.map(lambda ex_text, ex_title: preprocess_pipeline.fromtensor_pipeline( ex_text.decode(&quot;utf-8&quot;) ))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset_wiki</span> <span class="o">=</span> <span class="p">[</span><span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">fromtensor_pipeline</span><span class="p">(</span> <span class="n">ex</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="p">)</span> <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span>  <span class="n">tfds</span><span class="o">.</span><span class="n">as_numpy</span><span class="p">(</span><span class="n">ds</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_dataset_wiki</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span> <span class="n">dataset_wiki</span> <span class="p">,</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Build your input pipeline</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get Numpy Arrays</span>
<span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">tfds</span><span class="o">.</span><span class="n">as_numpy</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1">#print( preprocess_pipeline.fromtensor_pipeline( ex[&#39;text&#39;].decode(&quot;utf-8&quot;) ) )</span>
    <span class="c1">#print(&quot;NEXT!!!&quot;)</span>
    <span class="c1">#print(ex[&#39;text&#39;].decode(&quot;utf-8&quot;))</span>
    <span class="c1">#print(ex)</span>
    <span class="c1">#np_text, np_title = ex[&#39;text&#39;], ex[&#39;title&#39;]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">frombatch_pipeline</span><span class="p">(</span> <span class="n">ex</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">unbatch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np_text</span><span class="p">[</span><span class="mi">90</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">np_text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ex</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ds</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;system&#39;</span><span class="p">:</span><span class="s1">&#39;wiki&#39;</span><span class="p">,</span>
    <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="s1">&#39;test_data/&#39;</span><span class="p">,</span>
    <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="4.-Processing-from-Semeru-Format-and-Converting-into-Mappings">4. Processing from Semeru Format and Converting into Mappings<a class="anchor-link" href="#4.-Processing-from-Semeru-Format-and-Converting-into-Mappings">&#182;</a></h1><blockquote><p>@danaderp July 29'20</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Setting Up SemeruFormat</span>
<span class="k">def</span> <span class="nf">libest_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;libest&#39;</span><span class="p">,</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;req&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;LibEST_semeru_format/requirements&#39;</span><span class="p">),</span>
            <span class="s1">&#39;src&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;LibEST_semeru_format/source_code&#39;</span><span class="p">),</span>
            <span class="s1">&#39;tc&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;LibEST_semeru_format/test&#39;</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;ends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span><span class="s1">&#39;.h&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">model_prefix</span><span class="p">,</span>
        <span class="s1">&#39;encoding&#39;</span><span class="p">:</span><span class="s1">&#39;utf-8&#39;</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ebt_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;ebt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;req&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/requirements&#39;</span><span class="p">),</span>
            <span class="s1">&#39;tc&#39;</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/test_cases&#39;</span><span class="p">),</span>
            <span class="s1">&#39;src&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/source_code&#39;</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;ends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.java&#39;</span><span class="p">,</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span><span class="s1">&#39;.h&#39;</span><span class="p">,</span><span class="s1">&#39;.TXT&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">model_prefix</span><span class="p">,</span>
        <span class="c1">#&#39;encoding&#39;:&#39;ISO-8859-1&#39;</span>
        <span class="s1">&#39;encoding&#39;</span><span class="p">:</span><span class="s1">&#39;utf-8&#39;</span> <span class="c1">#english encoding</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">itrust_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;itrust&#39;</span><span class="p">,</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;uc&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;iTrust_semeru_format/use_cases&#39;</span><span class="p">),</span>
            <span class="s1">&#39;src&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;iTrust_semeru_format/source_code&#39;</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;ends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.java&#39;</span><span class="p">,</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span><span class="s1">&#39;.h&#39;</span><span class="p">,</span><span class="s1">&#39;.TXT&#39;</span><span class="p">,</span><span class="s1">&#39;.jsp&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">model_prefix</span><span class="p">,</span>
        <span class="s1">&#39;encoding&#39;</span><span class="p">:</span><span class="s1">&#39;ISO-8859-1&#39;</span>
        <span class="c1">#&#39;encoding&#39;:&#39;utf-8&#39; #english encoding</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">smos_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;smos&#39;</span><span class="p">,</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;italian&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;uc&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;SMOS_semeru_format/use_cases&#39;</span><span class="p">),</span>
            <span class="s1">&#39;src&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;SMOS_semeru_format/source_code&#39;</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;ends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.java&#39;</span><span class="p">,</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span><span class="s1">&#39;.h&#39;</span><span class="p">,</span><span class="s1">&#39;.TXT&#39;</span><span class="p">,</span><span class="s1">&#39;.jsp&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">model_prefix</span><span class="p">,</span>
        <span class="s1">&#39;encoding&#39;</span><span class="p">:</span><span class="s1">&#39;ISO-8859-1&#39;</span>
        <span class="c1">#&#39;encoding&#39;:&#39;utf-8&#39; #english encoding</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#parameters = libest_params(model_prefix=model_prefix[&#39;bpe8k&#39;])</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">smos_params</span><span class="p">()</span>
<span class="n">parameters</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;system&#39;: &#39;smos&#39;,
 &#39;saving_path&#39;: &#39;../dvc-ds4se/se-benchmarking/traceability/testbeds/processed/&#39;,
 &#39;language&#39;: &#39;italian&#39;,
 &#39;dataset&#39;: {&#39;uc&#39;: PosixPath(&#39;../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/use_cases&#39;),
  &#39;src&#39;: PosixPath(&#39;../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/source_code&#39;)},
 &#39;ends&#39;: [&#39;.txt&#39;, &#39;.java&#39;, &#39;.c&#39;, &#39;.h&#39;, &#39;.TXT&#39;, &#39;.jsp&#39;],
 &#39;model_prefix&#39;: &#39;../dvc-ds4se/models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;,
 &#39;encoding&#39;: &#39;ISO-8859-1&#39;}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;uc&#39;, &#39;src&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;artifacts: &quot;</span>  <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;artifacts: &quot;</span>  <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">][</span><span class="s1">&#39;uc&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-01-11 23:50:05,499 : INFO : artifacts: dict_keys([&#39;uc&#39;, &#39;src&#39;])
2021-01-11 23:50:05,500 : INFO : artifacts: ../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/use_cases
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">][</span><span class="s1">&#39;uc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;**/*&#39;</span> <span class="o">+</span> <span class="s2">&quot;.txt&quot;</span> <span class="p">)]</span>
<span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/use_cases/SMOS37.txt&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="p">[(</span><span class="n">filename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="n">open_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;encoding&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(PosixPath(&#39;../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/use_cases/SMOS37.txt&#39;),
 &#39;SMOS37.txt&#39;,
 &#34;Nome: InserisciNota\nAttori: Amministratore\nDescrizione: Inserimento Note Disciplinari\nPrecondizioni:\nâ\x80¢ â\x80¢ â\x80¢ â\x80¢\nL&#39;utente deve essere loggato al sistema come Amministratore L&#39;utente ha svolto il caso d&#39;uso â\x80\x9cVisualizzaDettagliSingoloRegistroâ\x80\x9d L&#39;utente ha giÃ\xa0 svolto il caso d&#39;uso â\x80\x9cVisualizzaElencoNoteâ\x80\x9d L&#39;utente clicca sul pulsante â\x80\x9cNuova notaâ\x80\x9d\nSequenza degli eventi\nUtente\nSistema\n2. Compila il form 3. Clicca su â\x80\x9cSalvaâ\x80\x9d\n1. Mostra un form con i campi della nota (studente, data, docente , descrizione).\n4. Salva la nota e invia una notifica via e-mail al genitore\nPostcondizioni:\nâ\x80¢\nâ\x80¢ â\x80¢\nI dati della nota sono stati inseriti nel sistema, ed il sistema ha inviato la notifica ai genitori. Il sistema ritorna alla schermata del registro. Lâ\x80\x99amministratore interrompe lâ\x80\x99operazione Connessione al server SMOS interrotta&#34;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="loading_artifacts" class="doc_header"><code>loading_artifacts</code><a href="ds4se/mgmnt/prep/conv.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>loading_artifacts</code>(<strong><code>params</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">loading_artifacts</span><span class="p">(</span> <span class="n">params</span> <span class="o">=</span> <span class="n">parameters</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-01-11 23:50:14,606 : INFO : artifacts: 67
2021-01-11 23:50:14,619 : INFO : artifacts: 100
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test</span><span class="p">[</span><span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;src&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ids</th>
      <th>filenames</th>
      <th>text</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ManagerClassroom.java</td>
      <td>package smos.storage;\n\n\nimport java.sql.Con...</td>
      <td>src</td>
    </tr>
    <tr>
      <th>68</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletUpdateUser.java</td>
      <td>package smos.application.userManagement;\n\nim...</td>
      <td>src</td>
    </tr>
    <tr>
      <th>69</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletComputateStatistics.java</td>
      <td>package smos.application.registerManagement;\n...</td>
      <td>src</td>
    </tr>
    <tr>
      <th>70</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletProva.java</td>
      <td>package smos.application.teachingManagement;\n...</td>
      <td>src</td>
    </tr>
    <tr>
      <th>71</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletInitialize.java</td>
      <td>package smos.application;\n\nimport javax.serv...</td>
      <td>src</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="processing_artifacts" class="doc_header"><code>processing_artifacts</code><a href="ds4se/mgmnt/prep/conv.py#L213" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>processing_artifacts</code>(<strong><code>model_prefix</code></strong>, <strong><code>df_sys_all</code></strong>, <strong><code>funct_params</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test_sys</span><span class="p">,</span><span class="n">r_prep</span> <span class="o">=</span> <span class="n">processing_artifacts</span><span class="p">(</span> <span class="n">model_prefix</span> <span class="o">=</span> <span class="n">model_prefix</span><span class="p">,</span> 
                                          <span class="n">df_sys_all</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">,</span> 
                                          <span class="n">funct_params</span> <span class="o">=</span> <span class="n">smos_params</span> <span class="c1">#itrust_params#ebt_params</span>
                                         <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-01-11 23:51:45,591 : INFO : fromtokens_pipeline: clean punctuation
2021-01-11 23:51:45,627 : INFO : fromtokens_pipeline: camel case
2021-01-11 23:51:45,630 : INFO : fromtokens_pipeline: lowe case
2021-01-11 23:51:45,631 : INFO : fromtokens_pipeline: white space removed
2021-01-11 23:51:45,663 : INFO : fromtokens_pipeline: WordPunctTokenizer
2021-01-11 23:51:45,922 : INFO : fromtokens_pipeline: Stop words
2021-01-11 23:51:46,655 : INFO : fromtokens_pipeline: Stemmings
2021-01-11 23:51:46,670 : INFO : fromtokens_pipeline: Removed Special Terns
2021-01-11 23:51:46,672 : INFO : fromtokens_pipeline END
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test_sys</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ids</th>
      <th>filenames</th>
      <th>text</th>
      <th>type</th>
      <th>bpe8k</th>
      <th>bpe32k</th>
      <th>bpe128k</th>
      <th>conv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>SMOS37.txt</td>
      <td>Nome: InserisciNota\nAttori: Amministratore\nD...</td>
      <td>uc</td>
      <td>[▁n, ome, :, ▁ins, er, isc, in, ota, \n, att, ...</td>
      <td>[▁n, ome, :, ▁ins, er, isc, in, ota, \n, att, ...</td>
      <td>[▁nome, :, ▁ins, er, isc, in, ota, \n, att, or...</td>
      <td>nome inserisci nota attori amministrator descr...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>SMOS16.txt</td>
      <td>Nome: EliminaClasse\nAttori: Amministratore\nD...</td>
      <td>uc</td>
      <td>[▁n, ome, :, ▁elimin, ac, las, se, \n, att, or...</td>
      <td>[▁n, ome, :, ▁elimin, ac, las, se, \n, att, or...</td>
      <td>[▁nome, :, ▁elimin, ac, lasse, \n, att, ori, :...</td>
      <td>nome elimina class attori amministrator descri...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>SMOS24.txt</td>
      <td>Nome:VisualizzaDettagliInsegnamento\nAttori: A...</td>
      <td>uc</td>
      <td>[▁n, ome, :, vis, ual, iz, z, ad, ett, ag, li,...</td>
      <td>[▁n, ome, :, vis, ual, izz, ad, ett, ag, li, i...</td>
      <td>[▁nome, :, visual, izz, ad, ett, agli, in, se,...</td>
      <td>nome visualizza dettag insegnamento attori amm...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>SMOS36.txt</td>
      <td>Nome: InserisciGiustifica\nAttori: Amministrat...</td>
      <td>uc</td>
      <td>[▁n, ome, :, ▁ins, er, isc, ig, i, ust, ific, ...</td>
      <td>[▁n, ome, :, ▁ins, er, isc, igi, ust, ific, a,...</td>
      <td>[▁nome, :, ▁ins, er, isc, igi, ust, ific, a, \...</td>
      <td>nome inserisci giustifica attori amministrator...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>SMOS26.txt</td>
      <td>Nome: EliminaInsegnamento\nAttori: Amministrat...</td>
      <td>uc</td>
      <td>[▁n, ome, :, ▁elimin, ain, se, gn, ament, o, \...</td>
      <td>[▁n, ome, :, ▁elimin, ain, se, gn, amento, \n,...</td>
      <td>[▁nome, :, ▁elimin, ain, se, gn, amento, \n, a...</td>
      <td>nome elimina insegnamento attori amministrator...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test_sys</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PosixPath(&#39;../dvc-ds4se/se-benchmarking/traceability/datasets/formatted/semeru_format/SMOS_semeru_format/use_cases/SMOS37.txt&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_test_sys</span><span class="p">[</span><span class="n">df_test_sys</span><span class="p">[</span><span class="s1">&#39;filenames&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;.java&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ids</th>
      <th>filenames</th>
      <th>text</th>
      <th>type</th>
      <th>bpe8k</th>
      <th>bpe32k</th>
      <th>bpe128k</th>
      <th>conv</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>67</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ManagerClassroom.java</td>
      <td>package smos.storage;\n\n\nimport java.sql.Con...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., st, or, age, ;, \n\n\...</td>
      <td>[▁package, ▁sm, os, ., stor, age, ;, \n\n\n, i...</td>
      <td>[▁package, ▁sm, os, ., storage, ;, \n\n\n, imp...</td>
      <td>packag smos storag import java sql connect imp...</td>
    </tr>
    <tr>
      <th>68</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletUpdateUser.java</td>
      <td>package smos.application.userManagement;\n\nim...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., u...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., us, e...</td>
      <td>[▁package, ▁sm, os, ., application, ., us, erm...</td>
      <td>packag smos applic user manag import smos envi...</td>
    </tr>
    <tr>
      <th>69</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletComputateStatistics.java</td>
      <td>package smos.application.registerManagement;\n...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., r...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., reg, ...</td>
      <td>[▁package, ▁sm, os, ., application, ., registe...</td>
      <td>packag smos applic regist manag import java io...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletProva.java</td>
      <td>package smos.application.teachingManagement;\n...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., t...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., te, a...</td>
      <td>[▁package, ▁sm, os, ., application, ., teachin...</td>
      <td>packag smos applic teach manag import javax se...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletInitialize.java</td>
      <td>package smos.application;\n\nimport javax.serv...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ;, \...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ;, \n\n,...</td>
      <td>[▁package, ▁sm, os, ., application, ;, \n\n, i...</td>
      <td>packag smos applic import javax servlet servle...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>162</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletReportTeachings.java</td>
      <td>package smos.application.userManagement;\n\nim...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., u...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., us, e...</td>
      <td>[▁package, ▁sm, os, ., application, ., us, erm...</td>
      <td>packag smos applic user manag import smos envi...</td>
    </tr>
    <tr>
      <th>163</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletAssignRole.java</td>
      <td>package smos.application.userManagement;\n\nim...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., u...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., us, e...</td>
      <td>[▁package, ▁sm, os, ., application, ., us, erm...</td>
      <td>packag smos applic user manag import smos envi...</td>
    </tr>
    <tr>
      <th>164</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>display.java</td>
      <td>\n\n/****************** displaytag stylesheet ...</td>
      <td>src</td>
      <td>[▁, \n\n, /, *, *, *, *, *, *, *, *, *, *, *, ...</td>
      <td>[▁, \n\n, /, *, *, *, *, *, *, *, *, *, *, *, ...</td>
      <td>[▁, \n\n, /, **, **, **, **, **, **, **, **, *...</td>
      <td>displaytag stylesheet tabl datat border color ...</td>
    </tr>
    <tr>
      <th>165</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletInsertReport.java</td>
      <td>package smos.application.reportManagement;\n\n...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., r...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., re, p...</td>
      <td>[▁package, ▁sm, os, ., application, ., report,...</td>
      <td>packag smos applic report manag import smos en...</td>
    </tr>
    <tr>
      <th>166</th>
      <td>../dvc-ds4se/se-benchmarking/traceability/data...</td>
      <td>ServletShowAddressDetails.java</td>
      <td>package smos.application.addressManagement;\n\...</td>
      <td>src</td>
      <td>[▁pack, age, ▁sm, os, ., ap, pl, ication, ., a...</td>
      <td>[▁package, ▁sm, os, ., appl, ication, ., add, ...</td>
      <td>[▁package, ▁sm, os, ., application, ., address...</td>
      <td>packag smos applic address manag import smos e...</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r_prep</span><span class="o">.</span><span class="n">SaveCorpus</span><span class="p">(</span><span class="n">df_test_sys</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;all-corpus&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-01-11 23:46:32,071 : INFO : Saving in...../dvc-ds4se/se-benchmarking/traceability/testbeds/processed/[itrust-all-corpus-1610408791.737875].csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r_prep</span><span class="o">.</span><span class="n">LoadCorpus</span><span class="p">(</span><span class="mf">1609221582.171744</span><span class="p">,</span><span class="n">language</span><span class="o">=</span><span class="s1">&#39;all-corpus&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;~&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pre-processing-from-Semeru-Format">Pre-processing from Semeru Format<a class="anchor-link" href="#Pre-processing-from-Semeru-Format">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Special Case EBT To Create Separate Files [Only one implementation]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Canonical EBT</span>
<span class="k">def</span> <span class="nf">ebt_params</span><span class="p">(</span><span class="n">model_prefix</span> <span class="o">=</span> <span class="n">path_data</span><span class="o">+</span><span class="s1">&#39;models/bpe/sentencepiece/wiki_py_java_bpe_8k&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;system&#39;</span><span class="p">:</span> <span class="s1">&#39;ebt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;saving_path&#39;</span><span class="p">:</span> <span class="n">path_data</span><span class="o">+</span> <span class="s1">&#39;se-benchmarking/traceability/testbeds/processed/&#39;</span><span class="p">,</span>
        <span class="s1">&#39;language&#39;</span><span class="p">:</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;req&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/requirements.txt&#39;</span><span class="p">),</span>
            <span class="s1">&#39;tc&#39;</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/test_cases.txt&#39;</span><span class="p">),</span>
            <span class="s1">&#39;src&#39;</span><span class="p">:</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/source_code&#39;</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="s1">&#39;ends&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.java&#39;</span><span class="p">,</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span><span class="s1">&#39;.h&#39;</span><span class="p">,</span><span class="s1">&#39;.TXT&#39;</span><span class="p">],</span>
        <span class="s1">&#39;model_prefix&#39;</span><span class="p">:</span><span class="n">model_prefix</span><span class="p">,</span>
        <span class="c1">#&#39;encoding&#39;:&#39;ISO-8859-1&#39;</span>
        <span class="s1">&#39;encoding&#39;</span><span class="p">:</span><span class="s1">&#39;utf-8&#39;</span> <span class="c1">#english encoding</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">ebt_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">][</span><span class="s1">&#39;req&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd_ebt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">][</span><span class="s1">&#39;req&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s2">&quot;/t&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">][</span><span class="s1">&#39;tc&#39;</span><span class="p">])</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">Lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">Lines</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">))</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">semeru_format</span> <span class="o">+</span> <span class="s1">&#39;EBT_semeru_format/test_cases/&#39;</span><span class="o">+</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">wp</span><span class="p">:</span> 
            <span class="n">wp</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dict_filenames</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#creating the function</span>
<span class="c1">#base_dir = os.path.abspath(os.getcwd())</span>
<span class="n">test_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;test_data/LibEST_semeru_format/test&#39;</span><span class="p">)</span>
<span class="c1">#path = os.path.join(base_dir, test_dir)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#reading all files in a folder</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span> <span class="s1">&#39;*.txt&#39;</span><span class="p">)):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># open in readonly mode</span>
        <span class="n">dict_filenames</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()]</span>      
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">test_dir</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#reading all files in a folder</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">test_dir</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">test_dir</span><span class="p">)]:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="c1"># open in readonly mode</span>
        <span class="n">dict_filenames</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()]</span>    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="s1">&#39;test_data/LibEST_semeru_format/requirements/RQ17.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;-pre.txt&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dict_filenames</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z\s]&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s2">&quot;Ho:;&lt;le_C$%&amp;\oMe_estTa?@[</span><span class="se">\\</span><span class="s2">is34~&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="o">|</span><span class="n">re</span><span class="o">.</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_terms</span><span class="p">(</span><span class="n">clean_punctuation</span><span class="p">(</span><span class="s2">&quot;their corresponding URIs:</span><span class="se">\n\n\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | Operation              |Operation path   | Details           |</span><span class="se">\n</span><span class="s2">   +========================+=================+===================+</span><span class="se">\n</span><span class="s2">   | Distribution of CA     | /cacerts        | Section 4.1       |</span><span class="se">\n</span><span class="s2">   | Certificates (MUST)    |                 |                   |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | Enrollment of          | /simpleenroll   | Section 4.2       |</span><span class="se">\n</span><span class="s2">   | Clients (MUST)         |                 |                   |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | Re-enrollment of       | /simplereenroll | Section 4.2.2     |</span><span class="se">\n</span><span class="s2">   | Clients (MUST)         |                 |                   |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | Full CMC (OPTIONAL)    | /fullcmc        | Section 4.3       |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | Server-Side Key        | /serverkeygen   | Section 4.4       |</span><span class="se">\n</span><span class="s2">   | Generation (OPTIONAL)  |                 |                   |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n</span><span class="s2">   | CSR Attributes         | /csrattrs       | Section 4.5       |</span><span class="se">\n</span><span class="s2">   | (OPTIONAL)             |                 |                   |</span><span class="se">\n</span><span class="s2">   +------------------------+-----------------+-------------------+</span><span class="se">\n\n</span><span class="s2">  &quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_terms</span><span class="p">(</span><span class="n">split_camel_case_token</span><span class="p">(</span><span class="n">dict_filenames</span><span class="p">[</span><span class="s1">&#39;test_data/LibEST_semeru_format/requirements/RQ17.txt&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pre_process</span> <span class="o">=</span> <span class="n">preprocess_pipeline</span><span class="o">.</span><span class="n">basic_pipeline</span><span class="p">(</span><span class="n">dict_filenames</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pre_process</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Writing Into A File</span>
<span class="n">df_pre_processed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pre_process</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">])</span> 
<span class="c1">#/.../benchmarking/traceability/testbeds/nltk</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pre_processed</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">base_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">pre_path</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-pre-tc].csv&#39;</span>
<span class="n">final_path</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-vocab-tc].csv&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_pre_processed</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">pre_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">save_dict</span><span class="p">(</span><span class="n">a_dict</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="n">a_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">a_file</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">a_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
    <span class="n">a_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#1-Building the corpus vocabulary</span>
<span class="n">tokenizer_corpora</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">Tokenizer</span><span class="p">()</span>
<span class="n">tokenizer_corpora</span><span class="o">.</span><span class="n">fit_on_texts</span><span class="p">([</span><span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">pre_process</span><span class="p">])</span>

<span class="n">word2id</span> <span class="o">=</span> <span class="n">tokenizer_corpora</span><span class="o">.</span><span class="n">word_index</span>
<span class="n">id2word</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">word2id</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">save_dict</span><span class="p">(</span><span class="n">id2word</span><span class="p">,</span><span class="n">final_path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">id2word</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Merging All the Vocabulary</span>
<span class="n">vocab_path_tc</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-vocab-tc].csv&#39;</span>
<span class="n">df_read_vocab_tc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">vocab_path_tc</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_read_vocab_tc</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_path_src</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-vocab-src].csv&#39;</span>
<span class="n">df_read_vocab_src</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">vocab_path_src</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_read_vocab_src</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vocab_path_req</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-vocab-req].csv&#39;</span>
<span class="n">df_read_vocab_req</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">vocab_path_req</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ids&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_read_vocab_req</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">super_vocab_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_read_vocab_tc</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_read_vocab_src</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="nb">set</span><span class="p">(</span><span class="n">df_read_vocab_req</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">super_vocab_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_vocab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">super_vocab_set</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_all_vocab</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_all_vocab</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-vocab-all].csv&#39;</span><span class="p">,</span> 
                    <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Merging all the corpuses</span>
<span class="n">pre_doc_path_tc</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-pre-tc].csv&#39;</span>
<span class="n">pre_doc_path_req</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-pre-req].csv&#39;</span>
<span class="n">pre_doc_path_src</span> <span class="o">=</span> <span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-pre-src].csv&#39;</span>

<span class="c1">#df_read_pre_tc = pd.read_csv(pre_doc_path_tc, header=None, sep=&#39; &#39;) #Need to inclide sep </span>
<span class="n">pre_doc_path</span> <span class="o">=</span> <span class="p">[</span><span class="n">pre_doc_path_tc</span><span class="p">,</span> <span class="n">pre_doc_path_req</span><span class="p">,</span> <span class="n">pre_doc_path_src</span><span class="p">]</span>
<span class="n">lis</span><span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">df_read</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">df_read</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">pre_doc_path</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lis</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">,</span><span class="n">lis</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lis</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_reduced_pre</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">lis</span><span class="p">)</span> 
<span class="n">df_reduced_pre</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_reduced_pre</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/tf/main/benchmarking/traceability/testbeds/nltk/[libest-pre-all].csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h6 id="#">#<a class="anchor-link" href="##">&#182;</a></h6>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> nbdev_build_docs
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

