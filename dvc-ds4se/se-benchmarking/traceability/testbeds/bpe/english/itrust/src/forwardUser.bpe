▁<%@ page ▁language =" java " ▁content Type =" text / html ; ▁char set = ISO -8859-1" ▁page Encoding =" ISO -8859-1" ▁error Page ="/ logout . jsp "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . enums . TransactionType "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . DAOFactory "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . DBUtil "%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<%@ include ▁file ="/ authenticate . jsp " ▁%> ▁<% ▁if ( request . getUser Prin cipa l () ▁ != ▁null ) ▁{ ▁long ▁mid ▁= ▁Long . value Of ( request . getUser Prin cipa l (). getName ()); ▁// DAOFactory . getPr oductionInstance (). get TransactionDAO (). log Transaction ( TransactionType . AUTH E N TICA TE _ USER , ▁mid , ▁0 L , ▁" Authenticate d , ▁requesting ▁ home ▁page "); ▁prodDAO . get TransactionDAO () ▁ . log Transaction ( TransactionType . AUTH E N TICA TE _ USER , ▁mid , ▁0 L , ▁" Authenticate d , ▁requesting ▁ home ▁page "); ▁if ▁( request . is UserIn Role (" patient ")) ▁{ ▁response . send Redirect (" patient / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" uap ")) ▁{ ▁response . send Redirect (" uap / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" hcp ")) ▁{ ▁response . send Redirect (" hcp / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" er ")) ▁{ ▁response . send Redirect (" er / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" pha ")) ▁{ ▁response . send Redirect (" pha / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" admin ")) ▁{ ▁response . send Redirect (" admin / home . jsp "); ▁return ; ▁} ▁else ▁if ▁( request . is UserIn Role (" tester ")) ▁{ ▁response . send Redirect (" tester / home . jsp "); ▁// operation p ro file ▁return ; ▁} ▁else ▁if (! validSession ) ▁{ ▁session . invalidate (); ▁response . send Redirect ("/ iTrust / "); ▁} ▁else ▁if ▁( mid ▁== ▁0) ▁{ ▁session . invalidate (); ▁} ▁else ▁{ ▁response . send Redirect (" errors / no access . jsp "); ▁} ▁} ▁%>