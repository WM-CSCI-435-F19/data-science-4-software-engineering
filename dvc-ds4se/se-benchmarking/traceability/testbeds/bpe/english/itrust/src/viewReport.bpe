▁<%@ tag lib ▁uri ="/ W EB - INF / tags . tld " ▁prefix =" itrust " ▁%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . R eportRequestBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PersonnelDAO "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . ViewMyReport RequestsAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . View MyRecordsAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . ViewReportAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PatientBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PersonnelBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . OfficeVisitBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . HealthRecord "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . AllergyBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . FamilyMemberBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . DiagnosisBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . ProcedureBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PrescriptionBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . MedicationBean "%> ▁<%@ page ▁import =" java . text . NumberFormat " ▁%> ▁<%@ page ▁import =" java . text . DecimalFormat " ▁%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . Localization " ▁%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁ Comp reh ensive ▁Patient ▁Report "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁// long ▁loggedInMID ▁= ▁request . getUser Prin cipa l ()== null ▁? ▁0 L ▁: ▁Long . value Of ( request . getUser Prin cipa l (). getName ()); ▁PersonnelDAO ▁personnelDAO ▁= ▁new ▁PersonnelDAO ( prodDAO ); ▁ViewMyReport RequestsAction ▁rAction ▁= ▁new ▁ViewMyReport RequestsAction ( prodDAO , ▁loggedInMID . longValue ()); ▁int ▁ patientIndex ▁= ▁Integer . parse Int ( request . getParameter (" patient ")); ▁List < PatientBean > ▁patients ▁= ▁( List < PatientBean > ) ▁session . get Attribute (" patients "); ▁// session . remove Attribute (" patients "); ▁String ▁pidString ▁= ▁"" ▁+ ▁patients . get ( patientIndex ) . get MID (); ▁String ▁ rrString ▁= ▁request . getParameter (" requestID "); ▁long ▁patientMID ; ▁int ▁requestID ; ▁R eportRequestBean ▁reportRequest ; ▁try ▁{ ▁if ▁( pidString ▁== ▁null ▁|| ▁pidString . equals ("")) ▁throw ▁new ▁Exception (" Error : ▁patientMID ▁is ▁null "); ▁if ▁( rrString ▁== ▁null ▁|| ▁ rrString . equals ("")) ▁throw ▁new ▁Exception (" Error : ▁requestID ▁is ▁null "); ▁patientMID ▁= ▁Long . parse Long ( pidString ); ▁requestID ▁= ▁Integer . parse Int ( rrString ); ▁reportRequest ▁= ▁rAction . getReportRequest ( requestID ); ▁rAction . setViewed ( requestID ); ▁reportRequest ▁= ▁rAction . getReportRequest ( requestID ); ▁View MyRecordsAction ▁action ▁= ▁new ▁View MyRecordsAction ( prodDAO , ▁patientMID ); ▁ ViewReportAction ▁viewAction ▁= ▁new ▁ ViewReportAction ( prodDAO , ▁loggedInMID . longValue ()); ▁PatientBean ▁patient ▁= ▁action . getPatient (); ▁List < OfficeVisitBean > ▁officeVisits ▁= ▁action . get AllOfficeVisits (); ▁List < HealthRecord > ▁records ▁= ▁action . getAll HealthRecords (); ▁List < AllergyBean > ▁allergies ▁= ▁action . get Allergies (); ▁List < PatientBean > ▁represented ▁= ▁action . get Represented (); ▁List < PatientBean > ▁representing ▁= ▁action . get Representing (); ▁List < FamilyMemberBean > ▁family ▁= ▁action . get Family (); ▁List < DiagnosisBean > ▁diagnoses ▁= ▁viewAction . getDiagnose s ( patientMID ); ▁List < ProcedureBean > ▁procedures ▁= ▁viewAction . get Procedures ( patientMID ); ▁List < PrescriptionBean > ▁prescriptions ▁= ▁viewAction . getPrescriptions ( patientMID ); ▁List < PersonnelBean > ▁hcps ▁= ▁viewAction . getDeclaredHCP s ( patientMID ); ▁%>< h 3> Comp reh ensive ▁Patient ▁Report ▁for ▁<%= patient . getF ullName ()%></ h 3> ▁< div ▁align = center > ▁< table > ▁< tr >< td ▁v align = top > ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="2"> Patient ▁Information </ th > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Name :</ td > ▁< td ▁><%= patient . getF ullName ()%></ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Address :</ td > ▁< td ▁> ▁<%= patient . getStreetAddress 1()%>< br ▁/> ▁<%= ▁"" . equals ( patient . getStreetAddress 2 ()) ▁? ▁"" ▁: ▁patient . getStreetAddress 2() ▁+ ▁"< br ▁/> "%> ▁<%= patient . getStreetAddress 3 ()%>< br ▁/> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Phone :</ td > ▁< td ▁><%= patient . getPhone ()%></ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Email :</ td > ▁< td ▁><%= patient . getEmail ()%></ td > ▁</ tr > ▁</ table > ▁</ td > ▁< td ▁width ="15 px "> & nb sp ; </ td > ▁< td > ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="2"> I nsurance ▁Information </ th > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Name ▁( ID ) :</ td > ▁< td ▁><%= patient . getIc Name ()%> ▁(<%= patient . getIc ID ()%>)</ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Address :</ td > ▁< td ▁> ▁<%= patient . getIcAddress 1()%>< br ▁/> ▁<% =" " . equals ( patient . getIcAddress 2 ()) ▁? ▁"" ▁: ▁patient . getIcAddress 2() ▁+ ▁"< br ▁/> "%> ▁<%= patient . getIcAddress 3 ()%>< br ▁/> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader V ertical "> Phone :</ td > ▁< td ▁><%= patient . getIcPhone ()%></ td > ▁</ tr > ▁</ table > ▁</ td ></ tr > ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="10"> Health ▁Records </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Height </ td > ▁< td > Weight </ td > ▁< td > Smoke s ?</ td > ▁< td > Blood ▁Pressure </ td > ▁< td > HDL </ td > ▁< td > LDL </ td > ▁< td > Triglycerides </ td > ▁< td > Total ▁Cholesterol </ td > ▁< td > Last ▁Recorded </ td > ▁< td > By ▁Personnel </ td > ▁</ tr > ▁<% ▁PersonnelBean ▁personnel ; ▁for ( HealthRecord ▁hr ▁: ▁records ) ▁{ ▁personnel ▁= ▁personnelDAO . getPersonnel ( hr . getPersonnelID ()); ▁%> ▁< tr > ▁< td ▁align = center ><%= hr . get Height ()%> in </ td > ▁< td ▁align = center ><%= hr . get Weight () ▁%> lbs </ td > ▁< td ▁align = center ><%= hr . isSmoker () ▁? ▁" Y " ▁: ▁" N " ▁%></ td > ▁< td ▁align = center ><%= hr . getBloodPressure ()%> ▁mmHg </ td > ▁< td ▁align = center ><%= hr . get CholesterolHDL ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . get CholesterolLDL ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . get CholesterolTri ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . getTotalC holesterol ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . getDate Recorded ()%></ td > ▁< td ▁align = center ><%= personnel . getF ullName ()%></ td > ▁</ tr > ▁ <%}%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span =3> Diagnoses </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Visit ▁ID </ td > ▁< td > ICD ▁Code </ td > ▁< td > Description </ td > ▁</ tr > ▁<% if ( diagnoses . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁diagnoses ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁ NumberFormat ▁ numberFormatter ▁= ▁ NumberFormat . get Instance ( Localization . instance (). getC urrentLocale ()); ▁( ( DecimalFormat ) numberFormatter ) . set Maximum Fr action Digits ( 2 ); ▁( ( DecimalFormat ) numberFormatter ) . set Min i mu mF r action Digits ( 2 ); ▁for ( DiagnosisBean ▁diagnosis ▁: ▁diagnoses ){%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= diagnosis . getOv DiagnosisID ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= numberFormatter . format ( Float . parse Float ( diagnosis . getICDCode ())) %></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= diagnosis . get Description ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="2"> Designated ▁HCPs </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > HCP ▁Name </ td > ▁</ tr > ▁<% if ( hcp s . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁designated ▁HCPs ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( PersonnelBean ▁hcp ▁: ▁hcps ){%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= hcp . getF ullName ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="2"> Allergies </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Allergy ▁Description </ td > ▁< td > First ▁Found </ td > ▁</ tr > ▁<% if ( all er g ies . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁Allergies ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( AllergyBean ▁allergy ▁: ▁allergies ){%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= allergy . get Description ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= allergy . getFirstFound Str ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="3"> Procedures </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Visit ▁ID </ td > ▁< td > CPT ▁Code </ td > ▁< td > Description </ td > ▁</ tr > ▁<% if ( procedure s . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁procedures ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( ProcedureBean ▁procedure ▁: ▁procedures ){%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= procedure . getOv ProcedureID ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= procedure . getCPTCode ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= procedure . get Description ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="6" > Prescriptions </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Visit ▁ID </ th > ▁< th > NDCode </ th > ▁< th > StartDate </ th > ▁< th > EndDate </ th > ▁< th > Dosage </ th > ▁< th > Instructions </ th > ▁</ tr > ▁<% if ( prescriptions . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁prescriptions ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( PrescriptionBean ▁prescription ▁: ▁prescriptions ){%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . get VisitID ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . get Medication (). getNDCode ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . getStartDate Str ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . getEndDate Str ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . get Dosage ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= prescription . get Instructions ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="4"> Office ▁Visits </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Visit ▁Date </ th > ▁< th > HCP </ th > ▁< th > Hospital ▁ID </ th > ▁< th > Notes </ th > ▁</ tr > ▁<% if ( officeVisit s . size ()==0){ ▁%> ▁< tr > ▁< td ▁col span ="2" ▁ style =" text - align : ▁center ;"> No ▁office ▁visits ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( OfficeVisitBean ▁ov ▁: ▁officeVisits ){ ▁personnel ▁= ▁personnelDAO . getPersonnel ( ov . getHcp ID ()); ▁%> ▁< tr > ▁< td ▁ style =" text - align : ▁center ;"><%= ov . getVisitDate Str ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= personnel . getF ullName ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= ov . get HospitalID ()%></ td > ▁< td ▁ style =" text - align : ▁center ;"><%= ov . get Notes ()%></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="2"> K now n ▁Re lative s </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Name </ th > ▁< th > Relation </ th > ▁</ tr > ▁<% ▁if ( family . size ()==0){ %> ▁< tr > ▁< td ▁col span ="3" ▁ style =" text - align : ▁center ;"> No ▁ Relation s ▁on ▁record </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( FamilyMemberBean ▁member ▁: ▁family ) ▁{%> ▁< tr > ▁< td ><%= member . getF ullName ()%></ td > ▁< td ><%= member . get Relation ()%></ td > ▁</ tr > ▁<% ▁} ▁}%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th > Patients ▁<%= patient . get FirstName ()%> ▁is ▁representing </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Patient </ th > ▁</ tr > ▁<% if ( rep resented . size () ▁== 0 ){ ▁%> ▁< tr > ▁< td ><%= patient . get FirstName ()%> ▁is ▁not ▁representing ▁any ▁patients </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( PatientBean ▁p ▁: ▁represented ){%> ▁< tr > ▁< td ▁align = center > ▁<%= p . getF ullName ()%> ▁</ td > ▁</ tr > ▁<% ▁} ▁}%> ▁</ table > ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁> Patients ▁ Representing ▁<%= patient . get FirstName ()%></ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Patient </ th > ▁</ tr > ▁<% if ( re present ing . size () ▁== 0 ){ ▁%> ▁< tr > ▁< td ><%= patient . get FirstName ()%> ▁is ▁not ▁represented ▁by ▁any ▁patients </ td > ▁</ tr > ▁<%} ▁else ▁{ ▁for ( PatientBean ▁p ▁: ▁representing ){%> ▁< tr > ▁< td ▁align = center > ▁<%= p . getF ullName ()%> ▁</ td > ▁</ tr > ▁<% ▁} ▁}%> ▁</ table > ▁< br ▁/> ▁< br ▁/> ▁<%} ▁catch ▁( Exception ▁ex ) ▁{ ▁%><%= ex . getClass ()+" , ▁" ▁%><%= ex . get Cause ()+" , ▁" ▁%><%= ex . getMessage () ▁%> <% ▁} ▁%> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>