▁<%@ tag lib ▁uri ="/ W EB - INF / tags . tld " ▁prefix =" itrust " ▁%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ page ▁import =" java . util . ArrayList "%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . R eportRequestBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . ViewMyReport RequestsAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PersonnelBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PatientBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PatientDAO "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PersonnelDAO "%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁View ▁My ▁Report ▁Requests "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁PatientDAO ▁patientDAO ▁= ▁new ▁PatientDAO ( prodDAO ); ▁PersonnelDAO ▁personnelDAO ▁= ▁new ▁PersonnelDAO ( prodDAO ); ▁ViewMyReport RequestsAction ▁action ▁= ▁new ▁ViewMyReport RequestsAction ( prodDAO , ▁loggedInMID . longValue ()); ▁String ▁pidString ▁= ▁( String ) session . get Attribute (" pid "); ▁if ▁( null ▁ != ▁pidString ▁&& ▁! ▁"" . equals ( pidString )) ▁{ ▁try ▁{ ▁session . set Attribute (" pid ", ▁null ); ▁long ▁patientMID ▁= ▁Long . parse Long ( pidString ); ▁long ▁id ▁= ▁action . add ReportRequest ( patientMID ); ▁%>< span > Report ▁Request ▁Accepted </ span ><% ▁} ▁catch ▁( Exception ▁e ) ▁{ ▁%>< span ><%= e . getMessage ()%></ span ><% ▁} ▁} ▁else ▁{ ▁session . remove Attribute (" pid "); ▁} ▁List < R eportRequestBean > ▁list ▁= ▁action . getAllRe portRequestsFor Requester (); ▁%> ▁< br ▁/>< br ▁/> ▁< table ▁class =" f Table " ▁align =" center "> ▁< tr > ▁< th ▁col span ="10"> Report ▁Requests </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > ID </ td > ▁< td > Patient </ td > ▁< td > Requested ▁Date </ td > ▁< td > Viewed ▁Date </ td > ▁< td > Status </ td > ▁< td > Action </ td > ▁</ tr > ▁<% ▁List < PatientBean > ▁patients ▁= ▁new ▁ArrayList < PatientBean > (); ▁PatientBean ▁patient ; ▁PersonnelBean ▁personnel ; ▁int ▁index ▁= ▁0; ▁for ▁( R eportRequestBean ▁bean : list ) ▁{ ▁patient ▁= ▁patientDAO . getPatient ( bean . get PatientMID ()); ▁patients . add ( patient ); ▁%> ▁< tr > ▁< td ▁><%= bean . get ID ()%></ td > ▁< td ▁><%= patient . getF ullName ()%></ td > ▁< td ▁><%= bean . getRequestedDate String ()%></ td > ▁< td ▁><%= bean . getViewedDate String ()%></ td > ▁< td ▁><%= bean . get Status ()%></ td > ▁< td ▁>< a ▁href =" view Report . jsp ? patient =<%= index %>& requestID =<%= bean . get ID ()%>"> View </ a ></ td > ▁</ tr > ▁<% ▁index ▁++; ▁} ▁session . set Attribute (" patients ", ▁patients ); ▁%> ▁</ table > ▁< br ▁/> ▁< a ▁href ="/ iTrust / auth / getPatientID . jsp ? forward = hcp - uap / view MyReportRequests . jsp "> Add ▁a ▁new ▁Report ▁Request </ a > ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>