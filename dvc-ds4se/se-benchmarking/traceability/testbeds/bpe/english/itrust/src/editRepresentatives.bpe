▁<%@ tag lib ▁prefix =" itrust " ▁uri ="/ W EB - INF / tags . tld " ▁%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PatientBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . Edit Representatives Action "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . iTrustException " ▁%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁Manage ▁Representatives "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁< br ▁/> ▁<% ▁/* ▁Require ▁a ▁Patient ▁ID ▁first ▁*/ ▁String ▁pidString ▁= ▁( String ) session . get Attribute (" pid "); ▁if ▁( pidString ▁== ▁null ▁|| ▁1 ▁> ▁pidString . length ()) ▁{ ▁response . send Redirect ("/ iTrust / auth / getPatientID . jsp ? forward = hcp / edit Representatives . jsp "); ▁return ; ▁} ▁Edit Representatives Action ▁action ▁= ▁null ; ▁List < PatientBean > ▁representees ▁= ▁null ; ▁long ▁pid ▁= ▁0 L ; ▁try ▁{ ▁action ▁= ▁new ▁Edit Representatives Action ( prodDAO , loggedInMID . longValue (), ▁pidString ); ▁pid = action . get Pid (); ▁String ▁representee ▁= ▁request . getParameter (" UID _ repID "); ▁String ▁confirm ▁= ▁""; ▁if ( representee != null ▁&& ▁! representee . equals (" ")){ ▁confirm ▁= ▁action . add Representative ( representee ); ▁} ▁String ▁ removeId ▁= ▁request . getParameter (" removeId "); ▁if ( removeId != null ▁&& ▁! removeId . equals (" ")){ ▁confirm ▁= ▁action . remove Representative ( removeId ); ▁} ▁if (! " " . equals ( confirm )){ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrustMessage "><%= confirm %></ span > ▁</ div > ▁< br ▁/> ▁<% ▁} ▁} ▁catch ( iTrustException ▁it e ) ▁{ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrust Error "><%= ite . getMessage () ▁%></ span > ▁</ div > ▁< br ▁/> ▁<% ▁} ▁finally ▁{ ▁representees ▁= ▁action . get Represented ( pid ); ▁} ▁%> ▁< form ▁method =" post " ▁name =" mainForm "> ▁< input ▁type =" hidden " ▁name =" pid " ▁value ="<%= pid ▁%>"> ▁< input ▁type =" hidden " ▁id =" removeId " ▁name =" removeId " ▁value =""> ▁< script ▁type =" text / javascript "> ▁function ▁remove Re p ( repMID ) ▁{ ▁document . getElementById (" removeId "). value ▁= ▁ repMID ; ▁document . mainForm . submit (); ▁} ▁</ script > ▁< table ▁class =" f Table " ▁align =" center "> ▁< tr > ▁< th ▁col span ="3"> Current ▁Representatives </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Name </ td > ▁< td ▁ style =" width : ▁30 px "> Action </ td > ▁</ tr > ▁<% ▁if ( representees . size () ▁== 0 ) ▁{ ▁%> ▁< tr >< td ▁col span ="3" ▁ style =" text - align : ▁center ;"> No ▁representatives ▁specified </ td ></ tr > ▁<% ▁} ▁else ▁{ ▁for ( PatientBean ▁p ▁: ▁representees ){ ▁%> ▁< tr > ▁<!-- ▁< td ▁><%= p . get MID () ▁%></ td > - -> ▁< td ▁><%= p . getF ullName ()%></ td > ▁< td ▁>< a ▁href =" javascript : remove Re p ('<%= p . get MID ()%>' ) "> Remove </ a ></ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁< tr >< td ▁col span =2> < br ></ td ></ tr > ▁< tr > ▁< td ▁col span ="3"> ▁< table > ▁< tr > ▁< td >< b > Patient :</ b ></ td > ▁< td ▁ style =" width : ▁150 px ; ▁border : ▁1 px ▁solid ▁Gra y ;"> ▁< input ▁name =" UID _ repID " ▁value =" " ▁type =" hidden "> ▁< span ▁id =" NAME _ repID " ▁name =" NAME _ repID "> Not ▁specified </ span > ▁</ td > ▁< td > ▁<%@ include ▁file ="/ util / getUserFrame . jsp " ▁%> ▁< input ▁type =" button " ▁ onclick =" getUser (' repID ');" ▁value =" Find ▁User " ▁> ▁</ td > ▁</ tr > ▁</ table > ▁</ td > ▁</ tr > ▁</ table > ▁< br > ▁< div ▁align = center > ▁< input ▁name =" action " ▁type =" submit " ▁value =" Represent ▁this ▁patient "> ▁</ div > ▁</ form > ▁< br ▁/>< br ▁/>< br ▁/> ▁< itrust : patient Nav ▁/> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>