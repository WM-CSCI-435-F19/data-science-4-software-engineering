▁p ackage ▁edu . nc su . cs c . itrust . dao . mysql ; ▁import ▁java . sql . Connection ; ▁import ▁java . sql . P reparedStatement ; ▁import ▁java . sql . ResultSet ; ▁import ▁java . sql . SQLException ; ▁import ▁java . util . List ; ▁import ▁edu . nc su . cs c . itrust . DBUtil ; ▁import ▁edu . nc su . cs c . itrust . beans . ApptTypeBean ; ▁import ▁edu . nc su . cs c . itrust . beans . loaders . ApptTypeBean Loader ; ▁import ▁edu . nc su . cs c . itrust . dao . DAOFactory ; ▁import ▁edu . nc su . cs c . itrust . exception . DBException ; ▁public ▁class ▁ApptTypeDAO ▁{ ▁private ▁DAOFactory ▁factory ; ▁private ▁ApptTypeBean Loader ▁ atLoader ; ▁public ▁ApptTypeDAO ( DAOFactory ▁factory ) ▁{ ▁this . factory ▁= ▁factory ; ▁this . atLoader ▁= ▁new ▁ApptTypeBean Loader (); ▁} ▁public ▁List < ApptTypeBean > ▁ getApptType s () ▁throw s ▁SQLException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁ps ▁= ▁conn . prepare Statement (" SEL ECT ▁* ▁FROM ▁appointmenttype "); ▁ResultSet ▁rs ▁= ▁ps . execute Query (); ▁List < ApptTypeBean > ▁at List ▁= ▁this . atLoader . load List ( rs ); ▁DBUtil . close Connection ( conn , ▁ps ); ▁return ▁at List ; ▁} ▁public ▁boolean ▁add ApptType ( ApptTypeBean ▁apptType ) ▁throw s ▁SQLException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁ps ▁= ▁conn . prepare Statement ( ▁" INSERT ▁INT O ▁appointmenttype ▁( appt _ type , ▁duration ) ▁" ▁+ ▁" VALUES ▁(?, ▁? )"); ▁this . atLoader . load Parameters ( ps , ▁apptType ); ▁int ▁x ▁= ▁ps . execute Update (); ▁DBUtil . close Connection ( conn , ▁ps ); ▁if ( x ▁> ▁0) ▁return ▁true ; ▁else ▁return ▁false ; ▁} ▁public ▁boolean ▁ editApptType ( ApptTypeBean ▁apptType ) ▁throw s ▁SQLException , ▁DBException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁ps ▁= ▁conn . prepare Statement (" UPDATE ▁appointmenttype ▁SET ▁duration =? ▁ WH ERE ▁appt _ type =?" ); ▁ps . set Int ( 1, ▁apptType . getDuration ()); ▁ps . set String (2, ▁apptType . getName ()); ▁int ▁x ▁= ▁ps . execute Update (); ▁DBUtil . close Connection ( conn , ▁ps ); ▁if ( x ▁> ▁0) ▁return ▁true ; ▁else ▁return ▁false ; ▁} ▁}