▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . ResetPassword Action "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . FormValidat ionException "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . iTrustException "%> ▁<%@ include ▁file ="/ global . jsp "%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁ Reset ▁Password "; ▁%> ▁<%@ include ▁file ="/ header . jsp "%> ▁< h 1> Reset ▁Password </ h 1> ▁<% ▁ResetPassword Action ▁action ▁= ▁new ▁ResetPassword Action ( prodDAO ); ▁if ▁( action . is Max ed Out ( request . getRemote Addr ())) ▁{ ▁response . send Redirect ("/ iTrust / auth / forward ? error = Too + man y + at temp t s ! "); ▁} ▁long ▁mid ▁= ▁action . check MID ( request . getParameter (" mid ")); ▁String ▁role ▁= ▁null ; ▁try ▁{ ▁role ▁= ▁action . check Role ( mid , ▁request . getParameter (" role ")); ▁} ▁catch ▁( iTrustException ▁e ) ▁{ ▁%> ▁< span ▁> User ▁does ▁not ▁exist ▁with ▁this ▁role ▁and ▁mid . </ span > ▁<% ▁} ▁%> ▁< form ▁action ="/ iTrust / util / resetPassword . jsp " ▁method =" post "> ▁< table > ▁<% ▁if ▁( mid ▁== ▁0 ▁|| ▁role ▁== ▁null ) ▁{ ▁%> ▁< tr > ▁< td ▁col span =2> < b > P lease ▁enter ▁your ▁Role ▁and ▁MID </ b ></ td > ▁</ tr > ▁< tr > ▁< td > Role :</ td > ▁< td > ▁< select ▁name =" role "> ▁< option ▁value =" patient "> Patient </ option > ▁< option ▁value =" hcp "> HCP </ option > ▁< option ▁value =" uap "> UAP </ option > ▁< option ▁value =" er "> ER </ option > ▁< option ▁value =" pha "> PHA </ option > ▁</ select > ▁</ td > ▁</ tr > ▁< tr > ▁< td > MID :</ td > ▁< td > ▁< input ▁type = TEXT ▁maxlength =10 ▁name =" mid "> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁col span =2 ▁align = center > ▁< input ▁type =" submit " ▁value =" Submit "> ▁</ td > ▁</ tr > ▁<% ▁} ▁else ▁{ ▁String ▁answer ▁= ▁action . check Answer Null ( request ▁ . getParameter (" answer ")); ▁if ▁( answer ▁== ▁null ) ▁{ ▁try ▁{ ▁%> ▁< tr > ▁< td ▁col span =2> ▁< b ><%= action . get SecurityQuestion ( mid )%></ b > ▁</ td > ▁</ tr > ▁< tr > ▁< td > Answer :</ td > ▁< td >< input ▁type = password ▁maxlength = 50 ▁name =" answer "> ▁< input ▁type = hidden ▁name =" mid " ▁value ="<%= mid %>"> ▁< input ▁type = hidden ▁name =" role " ▁value ="<%= role %>"> </ td > ▁</ tr > ▁< tr > ▁< td > New ▁Password :</ td > ▁< td >< input ▁type = password ▁maxlength = 20 ▁name =" password "></ td > ▁</ tr > ▁< tr > ▁< td > Confirm :</ td > ▁< td >< input ▁type = password ▁maxlength = 20 ▁name =" confirmPassword "></ td > ▁</ tr > ▁< tr > ▁< td ▁col span =2 ▁align = center >< input ▁type =" submit " ▁value =" Submit "></ td > ▁</ tr > ▁<% ▁} ▁catch ▁( iTrustException ▁e ) ▁{ ▁%> ▁< tr > ▁< td > ▁< font ▁color =' r ed '> This ▁user ▁has ▁not ▁set ▁a ▁security ▁question / answer . </ font > ▁</ td > ▁</ tr > ▁<% ▁} ▁} ▁else ▁{ ▁String ▁password ▁= ▁request . getParameter (" password "); ▁String ▁confirmPassword ▁= ▁request . getParameter (" confirmPassword "); ▁String ▁confirm ▁= ▁""; ▁try ▁{ ▁confirm ▁= ▁action . resetPassword ( mid , ▁role , ▁answer , ▁password , ▁confirmPassword , ▁request . getRemote Addr ()); ▁} ▁catch ▁( FormValidat ionException ▁e ) ▁{ ▁e . print HTML ( pageContext . get Out ()); ▁%> ▁< tr > ▁< td > ▁< a ▁href =" resetPassword . jsp "> ▁< h 2> P lease ▁try ▁again </ h 2> ▁</ a > ▁</ td > ▁</ tr > ▁<% ▁} ▁%> ▁< tr > ▁< td > ▁<%= confirm %> ▁</ td > ▁</ tr > ▁<% ▁} ▁} ▁%> ▁</ table > ▁</ form > ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>