▁p ackage ▁edu . nc su . cs c . itrust . action ; ▁import ▁java . util . Calendar ; ▁import ▁edu . nc su . cs c . itrust . beans . SurveyBean ; ▁import ▁edu . nc su . cs c . itrust . dao . DAOFactory ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . SurveyDAO ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . TransactionDAO ; ▁import ▁edu . nc su . cs c . itrust . enums . TransactionType ; ▁import ▁edu . nc su . cs c . itrust . exception . DBException ; ▁/** ▁* ▁This ▁class ▁is ▁used ▁to ▁add ▁patient ▁survey ▁data ▁to ▁the ▁database . ▁The ▁office ▁visit ▁ID ▁is ▁linked ▁with ▁the ▁survey ▁ID . ▁On ce ▁the ▁* ▁survey ▁is ▁added , ▁the ▁transaction ▁is ▁logged ▁* ▁*/ ▁public ▁class ▁SurveyAction ▁{ ▁private ▁TransactionDAO ▁transDAO ; ▁private ▁SurveyDAO ▁surveyDAO ; ▁long ▁loggedInMID ; ▁/** ▁* ▁Set s ▁up ▁defaults ▁* ▁@ param ▁factory ▁The ▁DAOFactory ▁used ▁to ▁create ▁the ▁DAOs ▁used ▁in ▁this ▁action . ▁* ▁@ param ▁loggedInMID ▁The ▁MID ▁of ▁the ▁user ▁taking ▁the ▁survey . ▁*/ ▁public ▁SurveyAction ( DAOFactory ▁factory , ▁long ▁loggedInMID ) ▁{ ▁transDAO ▁= ▁factory . get TransactionDAO (); ▁surveyDAO ▁= ▁factory . get SurveyDAO (); ▁this . loggedInMID ▁= ▁loggedInMID ; ▁} ▁/** ▁* ▁Pass ▁the ▁ OfficeVist Bean ▁a long ▁with ▁SurveyBean ▁* ▁@ param ▁surveyBean ▁contains ▁data ▁to ▁be ▁added ▁to ▁database ▁* ▁@ param ▁visitID ▁The ▁Office ▁Visit ▁ID ▁correspond ing ▁to ▁this ▁Survey . ▁* ▁@ throw s ▁DBException ▁*/ ▁public ▁void ▁add Survey ( SurveyBean ▁surveyBean , ▁long ▁visitID ) ▁throw s ▁DBException ▁{ ▁surveyBean . set VisitID ( visitID ); ▁// now ▁set ▁visit ▁ID ▁in ▁the ▁survey ▁bean ▁surveyDAO . add Completed Survey ( surveyBean , ▁Calendar . get Instance (). getTime ()); ▁// add ▁to ▁transaction ▁log ▁transDAO . log Transaction ( TransactionType . ADD _ PATIENT _ SURVEY , ▁loggedInMID , ▁0 L , ▁" off ice ▁visit ▁ID ▁for ▁completed ▁survey ▁is : ▁" ▁+ ▁visitID ); ▁} ▁}