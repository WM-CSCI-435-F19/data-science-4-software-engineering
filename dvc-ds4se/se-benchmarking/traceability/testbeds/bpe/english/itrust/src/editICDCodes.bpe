▁<%@ page ▁import =" java . net . URLEncoder " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . DAOFactory "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . DiagnosisBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . Update ICDCode ListAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . FormValidat ionException "%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁M aintain ▁ICD ▁Codes "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁String ▁headerMessage ▁= ▁" Viewing ▁Current ▁ICD ▁Codes "; ▁Update ICDCode ListAction ▁icdUpdater ▁= ▁new ▁Update ICDCode ListAction ( prodDAO , ▁loggedInMID . longValue ()); ▁if ▁( request . getParameter (" add ") ▁ != ▁null ▁|| ▁request . getParameter (" update ") ▁ != ▁null ) ▁{ ▁try ▁{ ▁DiagnosisBean ▁diag ▁= ▁new ▁DiagnosisBean ( request . getParameter (" code "), ▁request . getParameter (" description "), ▁request . getParameter (" classification ")); ▁headerMessage ▁= ▁( request . getParameter (" add ") ▁ != ▁null ) ? icd Update r . add ICDCode ( diag ) : icd Update r . update Information ( diag ); ▁} ▁catch ( FormValidat ionException ▁e ) ▁{ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrust Error "><%= e . getMessage () ▁%></ span > ▁</ div > ▁<% ▁headerMessage ▁= ▁" Validation ▁Errors "; ▁} ▁} ▁String ▁header Color ▁= ▁( headerMessage . index Of (" Error ") ▁> ▁-1) ▁? ▁"# ffc ccc " ▁: ▁"#00 C CCC "; ▁%> ▁< div ▁align = center > ▁< form ▁name =" mainForm " ▁method =" post "> ▁< input ▁type =" hidden " ▁id =" update ID " ▁name =" update ID " ▁value =" " ▁/> ▁< input ▁type =" hidden " ▁id =" ol dDescrip " ▁name =" ol dDescrip " ▁value =" " ▁/> ▁< script ▁type =" text / javascript "> ▁function ▁fillUpdate ( code ) ▁{ ▁document . getElementById (" code "). value ▁= ▁code ; ▁document . getElementById (" description "). value ▁= ▁un escape ( document . getElementById (" UPD " ▁+ ▁code ) . value ); ▁if ▁ (" yes " ▁== ▁document . getElementById (" CLASS "+ code ) . value ) ▁{ ▁document . getElementById (" classification "). checked ▁= ▁" checked "; ▁} ▁else ▁{ ▁document . getElementById (" classification "). checked ▁= ▁""; ▁} ▁} ▁</ script > ▁< br ▁/> ▁< span ▁class =" iTrustMessage "><%= headerMessage ▁%></ span > ▁< br ▁/> ▁< br ▁/> ▁< table ▁class =" f Table " ▁align =" center "> ▁< tr > ▁< th ▁col span ="3"> Update ▁ICD ▁Code ▁List </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Code </ th > ▁< th > Chronic ?</ th > ▁< th > Description </ th > ▁</ tr > ▁< tr > ▁< td >< input ▁type =" text " ▁name =" code " ▁id =" code " ▁size =" 8 " ▁maxlength =" 8 " ▁/></ td > ▁< td >< input ▁type =" checkbox " ▁name =" classification " ▁id =" classification " ▁value =" yes " ▁/></ td > ▁< td >< input ▁type =" text " ▁name =" description " ▁id =" description " ▁size ="40" ▁maxlength ="100 " ▁/></ td > ▁</ tr > ▁</ table > ▁< br ▁/> ▁< input ▁type =" submit " ▁name =" add " ▁value =" Add ▁Code " ▁/> ▁< input ▁type =" submit " ▁name =" update " ▁value =" Update ▁Code " ▁/> ▁< br ▁/> ▁< br ▁/> ▁< table ▁class =" f Table " ▁align =" center "> ▁< tr > ▁< th ▁col span ="3"> Current ▁ICD ▁Codes </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< th > Code </ th > ▁< th > Chronic ?</ th > ▁< th > Description </ th > ▁</ tr > ▁<% ▁List < DiagnosisBean > ▁codeList ▁= ▁prodDAO . get ICDCodesDAO (). getAll ICDCodes (); ▁String ▁tempCode ▁= ▁""; ▁String ▁ tempDescrip ▁= ▁""; ▁String ▁ tempClass ▁= ▁""; ▁String ▁ escapedDescrip ▁= ▁""; ▁for ▁( DiagnosisBean ▁codeEntry ▁: ▁codeList ) ▁{ ▁tempCode ▁= ▁codeEntry . getICDCode () ▁+ ▁""; ▁ tempDescrip ▁= ▁codeEntry . get Description (); ▁ tempClass ▁= ▁codeEntry . get Classification (); ▁ escapedDescrip ▁= ▁ URLEncoder . encode ( tempDescrip , ▁" UTF -8") . replace All (" \\ +", ▁" %20 "); ▁%> ▁< tr > ▁< td ▁align =" center "><%= tempCode %></ td > ▁< td ▁align =" center "><%= tempClass %></ td > ▁< td ▁align =" center "> ▁< a ▁href =" javascript : void (0)" ▁ onclick =" fillUpdate ('<%= tempCode ▁ %>')"><%= tempDescrip %></ a > ▁< input ▁type =" hidden " ▁id =" UPD <%= tempCode %>" ▁name =" UPD <%= tempCode %>" ▁value ="<%= escapedDescrip %>" ▁/> ▁< input ▁type =" hidden " ▁id =" CLASS <%= tempCode %>" ▁name =" CLASS <%= tempCode %>" ▁value ="<%= tempClass %>" ▁/> ▁</ td > ▁</ tr > ▁<% ▁} ▁%> ▁</ table > ▁</ form > ▁</ div > ▁< br ▁/> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>