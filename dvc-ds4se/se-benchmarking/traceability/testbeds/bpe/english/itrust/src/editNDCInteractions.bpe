▁<%@ page ▁import =" java . net . URLEncoder " ▁%> ▁<%@ page ▁import =" java . net . URL Decode r " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . DrugInteraction Action "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . iTrustException "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . FormValidat ionException "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . MedicationBean "%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁Edit ▁ND ▁Code ▁ Interactions "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁String ▁headerMessage ▁= ▁" Select ▁ND ▁Codes ▁with ▁Interaction "; ▁String ▁drug 1 ▁= ▁""; ▁String ▁drug 2 ▁= ▁""; ▁if ( request . getParameter (" drug 1 ") ▁ != ▁null ▁&& ▁request . getParameter (" drug 2 ") ▁ != ▁null ) ▁{ ▁drug 1 ▁= ▁request . getParameter (" drug 1 "). spl it (" ▁" ) [0 ] ; ▁drug 1 ▁= ▁drug 1 . replace (" - ", ▁" "); ▁drug 2 ▁= ▁request . getParameter (" drug 2 "). spl it (" ▁" ) [0 ] ; ▁drug 2 ▁= ▁drug 2 . replace (" - ", ▁" "); ▁} ▁if ▁( request . getParameter (" add ") ▁ != ▁null ) ▁{ ▁try ▁{ ▁DrugInteraction Action ▁interaction ▁= ▁new ▁DrugInteraction Action ( prodDAO , ▁loggedInMID . longValue ()); ▁headerMessage ▁= ▁interaction . report Interaction ( drug 1, ▁drug 2 , ▁request . getParameter (" description ")); ▁} ▁catch ( iTrustException ▁e ) ▁{ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrust Error "><%= e . getMessage () ▁%></ span > ▁</ div > ▁<% ▁} ▁catch ( FormValidat ionException ▁e ) ▁{ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrust Error "><%= e . getMessage () ▁%></ span > ▁</ div > ▁<% ▁} ▁} ▁String ▁header Color ▁= ▁( headerMessage . index Of (" Error ") ▁> ▁-1) ▁? ▁"# ffc ccc " ▁: ▁"#00 C CCC "; ▁%> ▁< br ▁/> ▁< div ▁align = center > ▁< form ▁name =" mainForm " ▁method =" post "> ▁< span ▁class =" iTrustMessage "><%= headerMessage ▁%></ span > ▁< br ▁/> ▁< br ▁/> ▁< table ▁cell padding ="10"> ▁< tr >< td > ▁< select ▁name =" drug 1 "> ▁<% ▁List < MedicationBean > ▁medList ▁= ▁prodDAO . get NDCodesDAO (). getAll NDCodes (); ▁String ▁tempCode ▁= ▁""; ▁String ▁ tempDescrip ▁= ▁""; ▁String ▁ escapedDescrip ▁= ▁""; ▁for ▁( MedicationBean ▁medEntry ▁: ▁medList ) ▁{ ▁tempCode ▁= ▁medEntry . getNDCode (); ▁ tempDescrip ▁= ▁medEntry . get Description (); ▁ escapedDescrip ▁= ▁ URLEncoder . encode ( tempDescrip , ▁" UTF -8") . replace All (" \\ +", ▁" %20 "); ▁%> ▁< option ><%= 5 ▁> ▁tempCode . length () ▁? ▁tempCode ▁: ▁tempCode . substring (0, ▁5) ▁%> - <%= 5 ▁> ▁tempCode . length () ▁? ▁"" ▁: ▁tempCode . substring ( 5 ) ▁%> ▁<%= tempDescrip ▁%> ▁</ option > ▁<% ▁} ▁%> ▁</ select ></ td >< td > ▁< select ▁name =" drug 2 "> ▁<% ▁for ▁( MedicationBean ▁medEntry ▁: ▁medList ) ▁{ ▁tempCode ▁= ▁medEntry . getNDCode (); ▁ tempDescrip ▁= ▁medEntry . get Description (); ▁ escapedDescrip ▁= ▁ URLEncoder . encode ( tempDescrip , ▁" UTF -8") . replace All (" \\ +", ▁" %20 "); ▁%> ▁< option ><%= 5 ▁> ▁tempCode . length () ▁? ▁tempCode ▁: ▁tempCode . substring (0, ▁5) ▁%> - <%= 5 ▁> ▁tempCode . length () ▁? ▁"" ▁: ▁tempCode . substring ( 5 ) ▁%> ▁<%= tempDescrip ▁%> ▁</ option > ▁<% ▁} ▁%> ▁</ select > ▁</ td ></ tr > ▁</ table > ▁< b > Description : ▁</ b >< input ▁type =" text " ▁id =" description " ▁name =" description " ▁size ="40" ▁maxlength ="50 0 " ▁/> ▁< br ▁/> ▁< br ▁/> ▁< input ▁type =" submit " ▁name =" add " ▁value =" Add ▁Interaction "> ▁< input ▁type =" button " ▁ onclick =" location . h ref =' / iTrust / auth / admin / edit NDCodes . jsp ' " ▁value =" Back " ▁name =" back " ▁id =" back "/> ▁</ form > ▁</ div > ▁< br ▁/> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>