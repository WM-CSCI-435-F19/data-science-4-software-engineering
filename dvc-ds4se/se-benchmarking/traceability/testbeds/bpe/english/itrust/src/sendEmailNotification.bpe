▁<%@ tag lib ▁uri ="/ W EB - INF / tags . tld " ▁prefix =" itrust "%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" java . util . ArrayList " ▁%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . Email " ▁%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PatientBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PersonnelBean " ▁%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PatientDAO "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PersonnelDAO " ▁%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . EmailUtil " ▁%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁HCP ▁- ▁send ▁Email ▁ Notification "; ▁%> ▁<%@ include ▁file ="/ header . jsp "%> ▁<% ▁PersonnelBean ▁self ▁= ▁new ▁PersonnelDAO ( prodDAO ) . getPersonnel ( loggedInMID ); ▁boolean ▁flag ; ▁long ▁mid ; ▁if ▁( request . getParameter (" mid ") ▁ != ▁null ▁&& ▁! request . getParameter (" mid "). equals I gnore Case ("")) ▁{ ▁mid ▁= ▁Long . parse Long ( request . getParameter (" mid ")); ▁flag ▁= ▁true ; ▁} ▁else ▁{ ▁flag ▁= ▁false ; ▁mid ▁= ▁0; ▁} ▁%> ▁<% ▁if ▁( flag ) ▁{ ▁PatientDAO ▁patients ▁= ▁new ▁PatientDAO ( prodDAO ); ▁PatientBean ▁ myPatient ▁= ▁patients . getPatient ( mid ); ▁%> ▁< center > ▁< table ▁border =10 ▁border color = darkred > ▁< tr >< td > ▁< form ▁action =" sendEmail Notification . jsp " ▁method = post > ▁< h 3> Send ▁Email ▁Form :</ h 3> ▁< table > ▁< tr > ▁< td > From : ▁</ td > ▁< td ><%= self . getF ullName () ▁%> ▁</ td > ▁</ tr > ▁< tr > ▁< td > To : ▁</ td > ▁< td > ▁< input ▁type = text ▁name =" email " ▁value ="<%= myPatient . getEmail () ▁%>"> ▁(<%= myPatient . getF ullName () ▁%> ) ▁</ td > ▁</ tr > ▁< tr > ▁< td > Subject :</ td > ▁< td > ▁< input ▁type = text ▁value =" Reminder " ▁name =" subject "> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁col span =2> ▁< textarea ▁name =" the text " ▁rows ="15 " ▁cols =" 43 "> Dea r ▁<%= myPatient . get FirstName () ▁%> , </ textarea > ▁</ td > ▁</ tr > ▁</ table > ▁< br ▁/> ▁< input ▁type = hidden ▁name =" id " ▁value ="<%= myPatient . get MID () ▁%>"> ▁< input ▁type = submit ▁value =" Send ▁Email "> ▁< input ▁type = re set ▁value =" Reset "> ▁</ form > ▁</ td ></ tr > ▁</ table > ▁</ center > ▁<% ▁} ▁else ▁{ ▁if ▁( request . getParameter (" email ") ▁== ▁null ▁|| ▁request . getParameter (" email "). equals ("")) ▁{ ▁response . send Redirect ("/ iTrust / auth / hcp / home . jsp "); ▁} ▁String ▁email ▁= ▁request . getParameter (" email "); ▁String ▁subject ▁= ▁request . getParameter (" subject "); ▁String ▁message ▁= ▁request . getParameter (" the text "); ▁long ▁id ▁= ▁Long . parse Long ( request . getParameter (" id ")); ▁Email ▁myEmail ▁= ▁new ▁Email (); ▁List < String > ▁toList ▁= ▁new ▁ArrayList < String > (); ▁toList . add ( email ); ▁myEmail . s etToList ( toList ); ▁myEmail . set From ( self . getEmail ()); ▁myEmail . s etBody ( message ); ▁myEmail . set Subject ( subject ); ▁EmailUtil ▁emailer ▁= ▁new ▁EmailUtil ( prodDAO ); ▁emailer . sendEmail ( my Email ); ▁PatientDAO ▁patients ▁= ▁new ▁PatientDAO ( prodDAO ); ▁PatientBean ▁ myPatient ▁= ▁patients . getPatient ( id ); ▁%> ▁< center > ▁< table ▁border =10 ▁border color = darkgreen > ▁< tr >< td > ▁< h 3 >< font ▁color =" darkred "> You r ▁Email ▁was ▁sent :</ font ></ h 3> ▁< table > ▁< tr > ▁< td > From : ▁</ td > ▁< td ><%= self . getF ullName () ▁%> ▁</ td > ▁</ tr > ▁< tr > ▁< td > To : ▁</ td > ▁< td > ▁< input ▁type = text ▁readonly ▁value ="<%= email ▁%>" ▁ style =" back g round - color : ▁ light gre y "> ▁(<%= myPatient . getF ullName () ▁%> ) ▁</ td > ▁</ tr > ▁< tr > ▁< td > Subject :</ td > ▁< td > ▁< input ▁type = text ▁readonly ▁value ="<%= ▁subject ▁%>" ▁ style =" back g round - color : ▁ light gre y "> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁col span =2> ▁< textarea ▁readonly ▁name =" the text " ▁rows ="15 " ▁cols =" 43 " ▁ style =" back g round - color : ▁ light gre y "><%= message ▁%></ textarea > ▁</ td > ▁</ tr > ▁</ table > ▁< br ▁/> ▁< form ▁action ="/ iTrust / auth / hcp / home . jsp " ▁method = get > ▁< input ▁type = submit ▁value =" Home "> ▁</ form > ▁</ td ></ tr > ▁</ table > ▁</ center > ▁<% ▁} ▁%> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>