▁p ackage ▁edu . nc su . cs c . itrust . action ; ▁import ▁edu . nc su . cs c . itrust . beans . ReferralBean ; ▁import ▁edu . nc su . cs c . itrust . dao . DAOFactory ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . ReferralDAO ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . TransactionDAO ; ▁import ▁edu . nc su . cs c . itrust . enums . TransactionType ; ▁import ▁edu . nc su . cs c . itrust . exception . iTrustException ; ▁import ▁edu . nc su . cs c . itrust . exception . DBException ; ▁import ▁java . util . List ; ▁/** ▁* ▁Used ▁for ▁ref err ing ▁patients ▁to ▁other ▁HCPs . ▁The ▁call ▁is ▁made ▁in ▁/ auth / hcp / hcp Consultation . jsp ▁*/ ▁public ▁class ▁Referral ManagementAction ▁{ ▁private ▁long ▁loggedInMID ; ▁private ▁TransactionDAO ▁transDAO ; ▁private ▁ReferralDAO ▁referralDAO ; ▁/** ▁* ▁S uper ▁class ▁validate s ▁the ▁patient ▁id ▁* ▁* ▁@ param ▁factory ▁The ▁DAOFactory ▁used ▁to ▁create ▁the ▁DAOs ▁used ▁in ▁this ▁action . ▁* ▁@ param ▁loggedInMID ▁The ▁MID ▁of ▁the ▁user ▁ managing ▁this ▁referral . ▁* ▁@ param ▁pidString ▁The ▁MID ▁of ▁the ▁patient ▁being ▁ref err ed . ▁* ▁@ throw s ▁iTrustException ▁*/ ▁public ▁Referral ManagementAction ( DAOFactory ▁factory , ▁long ▁loggedInMID ) ▁throw s ▁iTrustException ▁{ ▁this . ref err al DAO ▁= ▁factory . get ReferralDAO (); ▁this . loggedInMID ▁= ▁loggedInMID ; ▁this . transDAO ▁= ▁factory . get TransactionDAO (); ▁} ▁/** ▁* ▁Add s ▁a ▁referral ▁bean ▁to ▁the ▁database . ▁* ▁@ param ▁r ▁The ▁referral ▁bean ▁to ▁be ▁added . ▁* ▁@ throw s ▁DBException ▁*/ ▁public ▁void ▁send Referral ( ReferralBean ▁r ) ▁throw s ▁DBException ▁{ ▁referralDAO . add Referral ( r ); ▁transDAO . log Transaction ( TransactionType . SEND _ RE F ERR AL , ▁loggedInMID ); ▁} ▁/** ▁* ▁Updates ▁an ▁existing ▁referral ▁bean . ▁* ▁@ param ▁r ▁The ▁current ▁referral ▁bean . ▁* ▁@ throw s ▁DBException ▁*/ ▁public ▁void ▁update Referral ( ReferralBean ▁r ) ▁throw s ▁DBException ▁{ ▁referralDAO . edit Referral ( r ); ▁} ▁/** ▁* ▁Get s ▁the ▁referrals ▁the ▁currently ▁logged ▁in ▁MID ▁has ▁sent . ▁* ▁@ return ▁A ▁java . util . List ▁of ▁ReferralBean s ▁this ▁MID ▁has ▁sent . ▁* ▁@ throw s ▁DBException ▁*/ ▁public ▁List < ReferralBean > ▁ getReferralsSent FromMe () ▁throw s ▁DBException ▁{ ▁return ▁referralDAO . getReferralsSent From ( loggedInMID ); ▁} ▁/** ▁* ▁Get s ▁the ▁referrals ▁this ▁MID ▁has ▁received . ▁* ▁@ return ▁A ▁java . util . List ▁of ▁the ▁ReferralBean s ▁this ▁MID ▁has ▁received . ▁* ▁@ throw s ▁DBException ▁*/ ▁public ▁List < ReferralBean > ▁ getReferralsSent ToMe () ▁throw s ▁DBException ▁{ ▁return ▁referralDAO . getReferralsSent To ( loggedInMID ); ▁} ▁}