▁<%@ tag lib ▁prefix =" itrust " ▁uri ="/ W EB - INF / tags . tld " ▁%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp " ▁%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . LabProcedureBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . E ditPatientAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . LabProcHCPAction "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PatientBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PatientDAO "%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁View ▁Laboratory ▁Procedures "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁ LabProcHCPAction ▁action 2 ▁= ▁new ▁ LabProcHCPAction ( prodDAO , ▁loggedInMID . longValue ()); ▁if ( request . getParameter (" priv ") != null ▁&& ▁request . getParameter (" priv "). equals (" yes ")){ ▁action 2 . change Privacy ( Long . parse Long ( request . getParameter (" ID ")) ); ▁} ▁/* ▁Require ▁a ▁Patient ▁ID ▁first ▁*/ ▁String ▁pidString ▁= ▁( String ) session . get Attribute (" pid "); ▁if ▁( pidString ▁== ▁null ▁|| ▁1 ▁> ▁pidString . length ()) ▁{ ▁response . send Redirect ("/ iTrust / auth / getPatientID . jsp ? forward = hcp / LabProcHCP . jsp "); ▁return ; ▁} ▁else ▁{ ▁session . remove Attribute (" pid "); ▁} ▁/* ▁If ▁the ▁patient ▁id ▁does n ' t ▁check ▁out , ▁then ▁kick ▁' em ▁out ▁to ▁the ▁exception ▁handler ▁*/ ▁E ditPatientAction ▁action ▁= ▁new ▁E ditPatientAction ( prodDAO , loggedInMID . longValue (), pidString ); ▁long ▁pid ▁= ▁action . get Pid (); ▁List < LabProcedureBean > ▁proc ▁= ▁action 2 . view Procedures ( pid ); ▁%> ▁< br ▁/> ▁< table ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="11"> Lab ▁Procedures </ th > ▁</ tr > ▁< tr ▁class =" subHeader "> ▁< td > Patient </ td > ▁< td > Lab ▁Code </ td > ▁< td > Rights </ td > ▁< td > Status </ td > ▁< td > Commentary </ td > ▁< td > Results </ td > ▁< td > OfficeVisitID </ td > ▁< td > Updated ▁Date </ td > ▁< td > Edit ▁Office ▁Visit </ td > ▁< td > Change ▁Privacy </ td > ▁< td > Action </ td > ▁</ tr > ▁<% ▁if ( proc . size () ▁> ▁0) ▁{ ▁for ( LabProcedureBean ▁bean ▁: ▁proc ){ ▁PatientBean ▁patient ▁= ▁new ▁PatientDAO ( prodDAO ) . getPatient ( bean . get Pid ()); ▁%> ▁< tr > ▁< td ▁><%= patient . getF ullName ()%></ td > ▁< td ▁><%= bean . getLo inc ()%></ td > ▁< td ▁><%= bean . get Rights ()%></ td > ▁< td ▁><%= bean . get Status ()%></ td > ▁< td ▁><%= bean . get Commentary ()%></ td > ▁< td ▁><%= bean . get Results ()%></ td > ▁< td ▁><%= bean . getOv ID ()%></ td > ▁< td ▁><%= bean . get Timestamp ()%></ td > ▁< td ▁> ▁<% if ( action 2 . check Access ( bean . get ProcedureID ()) ){%> ▁< a ▁href ="/ iTrust / auth / hcp - uap / e ditOfficeVisit . jsp ? ovID =<%= bean . getOv ID ()%>"> Edit ▁Office ▁Visit </ a >< br ▁/> ▁<%} ▁%></ td > ▁< td ▁> ▁<% if ( action 2 . check Access ( bean . get ProcedureID ()) ){%> ▁< a ▁href ="/ iTrust / auth / hcp / LabProcHCP . jsp ? ID =<%= bean . get ProcedureID ()%>& priv = yes "> Allow / Di s allow ▁View ing </ a >< br ▁/> ▁<%} ▁%></ td > ▁< td ▁> ▁< a ▁href ="/ iTrust / auth / hcp / UpdateLabProc . jsp ? ID =<%= bean . get ProcedureID ()%>"> Update </ a >< br ▁/> ▁</ td > ▁</ tr > ▁<% ▁} ▁} ▁else ▁{ ▁%> ▁< tr ▁col span =10 > ▁< td ▁align = center > ▁No ▁Data ▁</ td > ▁</ tr > ▁<% ▁} ▁%> ▁</ table > ▁< br ▁/>< br ▁/> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>