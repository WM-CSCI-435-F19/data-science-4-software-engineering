▁<%@ tag lib ▁uri ="/ W EB - INF / tags . tld " ▁prefix =" itrust "%> ▁<%@ page ▁error Page ="/ auth / exception Handler . jsp "%> ▁<%@ page ▁import =" java . util . List "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . DAOFactory "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . action . E ditHealthHistory Action "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . HealthRecord "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . BeanBuilder "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . forms . HealthRecordForm "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . exception . FormValidat ionException "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . beans . PersonnelBean "%> ▁<%@ page ▁import =" edu . nc su . cs c . itrust . dao . mysql . PersonnelDAO "%> ▁<%@ include ▁file ="/ global . jsp " ▁%> ▁<% ▁pageTitle ▁= ▁" iTrust ▁- ▁Edit ▁Basic ▁Health ▁Record "; ▁%> ▁<%@ include ▁file ="/ header . jsp " ▁%> ▁<% ▁/* ▁Require ▁a ▁Patient ▁ID ▁first ▁*/ ▁String ▁pidString ▁= ▁( String ) session . get Attribute (" pid "); ▁if ▁( pidString ▁== ▁null ▁|| ▁1 ▁> ▁pidString . length ()) ▁{ ▁response . send Redirect ("/ iTrust / auth / getPatientID . jsp ? forward = hcp - uap / edit Basic Health . jsp "); ▁return ; ▁} ▁// else ▁{ ▁// ▁session . remove Attribute (" pid "); ▁// } ▁E ditHealthHistory Action ▁action ▁= ▁new ▁E ditHealthHistory Action ( prodDAO , loggedInMID . longValue (), ▁pidString ); ▁long ▁pid ▁= ▁action . get Pid (); ▁String ▁patientName ▁= ▁action . get PatientName (); ▁String ▁confirm ▁= ▁""; ▁if ▁ (" true " . equals ( request . getParameter (" formIsFilled "))) ▁{ ▁try ▁{ ▁confirm ▁= ▁action . add HealthRecord ( pid , ▁new ▁ BeanBuilder < HealthRecordForm > (). build ( request . getParameterMap (), ▁new ▁ HealthRecordForm ()) ); ▁} ▁catch ( FormValidat ionException ▁e ){ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrust Error " ><% e . print HTML ( pageContext . get Out ()); %></ span > ▁</ div > ▁< br ▁/> ▁<% ▁} ▁} ▁List < HealthRecord > ▁records ▁= ▁action . getAll HealthRecords ( pid ); ▁HealthRecord ▁ mostRecent ▁= ▁( records . size () ▁> ▁0) ▁? ▁records . get (0) ▁: ▁new ▁HealthRecord (); ▁// for ▁the ▁default ▁values ▁%> ▁< script ▁type =" text / javascript "> ▁function ▁ showAd dRow ( ){ ▁document . getElementById (" addRow "). style . display =" in line "; ▁document . getElementById (" addRow Button "). style . display =" none "; ▁document . forms [0 ] . height . f o c us (); ▁} ▁</ script > ▁<% ▁if ▁(!" " . equals ( confirm )) ▁{ ▁%> ▁< div ▁align = center > ▁< span ▁class =" iTrustMessage "><%= confirm %></ span > ▁</ div > ▁<% ▁} ▁%> ▁< br ▁/> ▁< div ▁align = center > ▁< table ▁align =" center " ▁class =" f Table "> ▁< tr > ▁< th ▁col span ="10"> Basic ▁Health ▁History </ th > ▁</ tr > ▁< tr ▁class ▁= ▁" subHeader "> ▁< td > Height </ td > ▁< td > Weight </ td > ▁< td > Smoke s ?</ td > ▁< td > Blood ▁Pressure </ td > ▁< td > HDL </ td > ▁< td > LDL </ td > ▁< td > Triglycerides </ td > ▁< td > Total ▁Cholesterol </ td > ▁< td > Last ▁Recorded </ td > ▁< td > By ▁Personnel </ td > ▁</ tr > ▁<% ▁for ▁( HealthRecord ▁hr ▁: ▁records ) ▁{ ▁%> ▁< tr > ▁< td ▁align = center ><%= hr . get Height ()%> in </ td > ▁< td ▁align = center ><%= hr . get Weight ()%> lbs </ td > ▁< td ▁align = center ><%= hr . isSmoker () ▁? ▁" Y " ▁: ▁" N "%></ td > ▁< td ▁align = center ><%= hr . getBloodPressure ()%> ▁mmHg </ td > ▁< td ▁align = center ><%= hr . get CholesterolHDL ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . get CholesterolLDL ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . get CholesterolTri ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . getTotalC holesterol ()%> ▁mg / dL </ td > ▁< td ▁align = center ><%= hr . getDate Recorded ()%></ td > ▁<% ▁PersonnelBean ▁p ▁= ▁prodDAO . get PersonnelDAO (). getPersonnel ( hr . getPersonnelID ()); ▁%> ▁< td ▁align = center ><%= p . getF ullName ()%></ td > ▁</ tr > ▁<% ▁} ▁%> ▁</ table > ▁< br ▁/> ▁< a ▁href =" javascript : showAd dRow (); " ▁id =" addRow Button " ▁ style =" text - deco ration : none ; " ▁> ▁< input ▁type = button ▁value =" Add ▁Record " ▁on Click =" showAd dRow (); "> ▁</ a > ▁</ div > ▁< br ▁/> ▁< div ▁id =" addRow " ▁ style =" display : ▁none ; " ▁align = center > ▁< form ▁action =" edit Basic Health . jsp " ▁method =" post "> ▁< input ▁type =" hidden " ▁name =" formIsFilled " ▁value =" true "> ▁< table ▁class =" f Table " ▁align =" center "> ▁< tr > ▁< th ▁col span ="2" ▁ style =" back g round - color : silver ;"> Record ▁Information </ th > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader "> Height ▁( in . ) :</ td > ▁< td ▁>< input ▁name =" height " ▁value ="<%= mostRecent . get Height ()%>" ▁ style =" width : ▁50 px " ▁type =" text " ▁maxlength ="5"> </ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader "> Weight ▁( lbs . ) :</ td > ▁< td ▁>< input ▁name =" weight " ▁value ="<%= mostRecent . get Weight ()%>" ▁ style =" width : ▁50 px " ▁type =" text " ▁maxlength ="5"> </ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader "> Smoker ? :</ td > ▁< td ▁>< input ▁type =" radio " ▁name =" isSmoker " ▁value =" false " ▁checked ▁/> ▁No ▁< input ▁type =" radio " ▁name =" isSmoker " ▁value =" true " ▁/> ▁ Yes </ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader "> Blood ▁Pressure ▁( mm H g ) :</ td > ▁< td ▁> ▁< input ▁name =" bloodPressureN " ▁value ="<%= mostRecent . get BloodPressureN ()%>" ▁ style =" width : ▁40 px " ▁maxlength ="3" ▁type =" text " ▁/> ▁/ ▁< input ▁name =" bloodPressureD " ▁value ="<%= mostRecent . get BloodPressureD ()%>" ▁ style =" width : ▁40 px " ▁maxlength ="3" ▁type =" text " ▁/> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁class =" subHeader "> Cholesterol ▁( mg / dL ) :</ td > ▁< td ▁> ▁< table > ▁< tr > ▁< td ▁ style =" text - align : ▁right "> HDL :</ td > ▁< td >< input ▁name =" cholesterolHDL " ▁value ="<%= mostRecent . get CholesterolHDL ()%>" ▁ style =" width : ▁ 38 px " ▁maxlength ="3" ▁type =" text "></ td > ▁</ tr > ▁< tr > ▁< td ▁ style =" text - align : ▁right "> LDL :</ td > ▁< td > ▁< input ▁name =" cholesterolLDL " ▁value ="<%= mostRecent . get CholesterolLDL ()%>" ▁ style =" width : ▁ 38 px " ▁maxlength ="3" ▁type =" text "> ▁</ td > ▁</ tr > ▁< tr > ▁< td ▁ style =" text - align : ▁right "> T ri :</ td > ▁< td > ▁< input ▁name =" cholesterolTri " ▁value ="<%= mostRecent . get CholesterolTri ()%>" ▁ style =" width : ▁ 38 px " ▁maxlength ="3" ▁type =" text "> ▁</ td > ▁</ tr > ▁</ table > ▁</ td > ▁</ tr > ▁</ table > ▁< br ▁/> ▁< input ▁type =" submit " ▁value =" Add ▁Record "> ▁</ form > ▁</ div > ▁< br ▁/> ▁< br ▁/> ▁< br ▁/> ▁< itrust : patient Nav ▁thisTitle =" Basic ▁Health ▁History " ▁/> ▁<%@ include ▁file ="/ f ooter . jsp " ▁%>