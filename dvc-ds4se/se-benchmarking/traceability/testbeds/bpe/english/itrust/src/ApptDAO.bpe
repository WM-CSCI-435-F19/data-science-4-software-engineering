▁p ackage ▁edu . nc su . cs c . itrust . dao . mysql ; ▁import ▁java . sql . Connection ; ▁import ▁java . sql . P reparedStatement ; ▁import ▁java . sql . ResultSet ; ▁import ▁java . sql . SQLException ; ▁import ▁java . util . List ; ▁import ▁edu . nc su . cs c . itrust . DBUtil ; ▁import ▁edu . nc su . cs c . itrust . beans . ApptBean ; ▁import ▁edu . nc su . cs c . itrust . beans . loaders . ApptBean Loader ; ▁import ▁edu . nc su . cs c . itrust . dao . DAOFactory ; ▁public ▁class ▁ApptDAO ▁{ ▁private ▁DAOFactory ▁factory ; ▁private ▁ApptBeanLoader ▁ abloader ; ▁public ▁ApptDAO ( DAOFactory ▁factory ) ▁{ ▁this . factory ▁= ▁factory ; ▁this . abloader ▁= ▁new ▁ApptBeanLoader (); ▁} ▁public ▁List < ApptBean > ▁ getAppts For ( long ▁mid ) ▁throw s ▁SQLException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁if ( mid ▁>= ▁( long ) ▁ 999999999 ){ ▁ps ▁= ▁conn . prepare Statement (" SEL ECT ▁* ▁FROM ▁appointment ▁ WH ERE ▁doctor _ id =? ▁OR DER ▁ BY ▁sched _ date ; "); ▁} ▁else ▁{ ▁ps ▁= ▁conn . prepare Statement (" SEL ECT ▁* ▁FROM ▁appointment ▁ WH ERE ▁patient _ id =? ▁OR DER ▁ BY ▁sched _ date ; "); ▁} ▁ps . s etLong ( 1, ▁mid ); ▁ResultSet ▁rs ▁= ▁ps . execute Query (); ▁List < ApptBean > ▁abList ▁= ▁this . abloader . load List ( rs ); ▁DBUtil . close Connection ( conn , ▁ps ); ▁return ▁abList ; ▁} ▁public ▁List < ApptBean > ▁getAll Appts () ▁throw s ▁SQLException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁ps ▁= ▁conn . prepare Statement (" SEL ECT ▁* ▁FROM ▁appointment ; "); ▁ResultSet ▁rs ▁= ▁ps . execute Query (); ▁List < ApptBean > ▁abList ▁= ▁this . abloader . load List ( rs ); ▁DBUtil . close Connection ( conn , ▁ps ); ▁return ▁abList ; ▁} ▁public ▁void ▁ scheduleAppt ( ApptBean ▁appt ) ▁throw s ▁SQLException ▁{ ▁ Connection ▁conn ▁= ▁null ; ▁P reparedStatement ▁ps ▁= ▁null ; ▁conn ▁= ▁factory . get Connection (); ▁ps ▁= ▁conn . prepare Statement ( ▁" INSERT ▁INT O ▁appointment ▁( appt _ type , ▁patient _ id , ▁doctor _ id , ▁sched _ date , ▁comment ) ▁" ▁+ ▁" VALUES ▁(?, ▁? , ▁? , ▁? , ▁? )"); ▁ps ▁= ▁this . abloader . load Parameters ( ps , ▁appt ); ▁ps . execute Update (); ▁DBUtil . close Connection ( conn , ▁ps ); ▁} ▁}