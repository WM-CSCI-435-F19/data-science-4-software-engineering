▁p ackage ▁edu . nc su . cs c . itrust . action ; ▁import ▁edu . nc su . cs c . itrust . RandomPassword ; ▁import ▁edu . nc su . cs c . itrust . beans . PersonnelBean ; ▁import ▁edu . nc su . cs c . itrust . dao . DAOFactory ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . AuthDAO ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . PersonnelDAO ; ▁import ▁edu . nc su . cs c . itrust . dao . mysql . TransactionDAO ; ▁import ▁edu . nc su . cs c . itrust . enums . Role ; ▁import ▁edu . nc su . cs c . itrust . enums . TransactionType ; ▁import ▁edu . nc su . cs c . itrust . exception . FormValidat ionException ; ▁import ▁edu . nc su . cs c . itrust . exception . iTrustException ; ▁import ▁edu . nc su . cs c . itrust . validate . Add Personnel Validator ; ▁/** ▁* ▁Used ▁for ▁Add ▁Personnel ▁page ▁( add Personnel . jsp ) . ▁This ▁just ▁add s ▁an ▁empty ▁PHA , ▁create s ▁a ▁random ▁password ▁* ▁for ▁them . ▁* ▁* ▁Ver y ▁similar ▁to ▁ {@ link ▁Add OfficeVisit Action } ▁and ▁ {@ link ▁ AddPatientAction } ▁* ▁*/ ▁public ▁class ▁Add PHA Action ▁{ ▁private ▁PersonnelDAO ▁personnelDAO ; ▁private ▁AuthDAO ▁authDAO ; ▁private ▁TransactionDAO ▁transDAO ; ▁private ▁long ▁loggedInMID ; ▁/** ▁* ▁Set s ▁up ▁the ▁defaults ▁for ▁the ▁class ▁* ▁* ▁@ param ▁factory ▁factory ▁for ▁creating ▁the ▁defaults . ▁* ▁@ param ▁loggedInMID ▁person ▁currently ▁logged ▁in ▁* ▁@ author ▁Andy ▁Men e ely ▁*/ ▁public ▁Add PHA Action ( DAOFactory ▁factory , ▁long ▁loggedInMID ) ▁{ ▁this . personnelDAO ▁= ▁factory . get PersonnelDAO (); ▁this . authDAO ▁= ▁factory . get AuthDAO (); ▁this . transDAO ▁= ▁factory . get TransactionDAO (); ▁this . loggedInMID ▁= ▁loggedInMID ; ▁} ▁/** ▁* ▁Add s ▁the ▁new ▁user . ▁Event ▁is ▁logged . ▁* ▁* ▁@ param ▁p ▁bean ▁containing ▁the ▁information ▁for ▁the ▁new ▁user ▁* ▁@ return ▁MID ▁of ▁the ▁new ▁user . ▁* ▁@ throw s ▁ FormValidat ionException ▁* ▁@ throw s ▁iTrustException ▁*/ ▁public ▁long ▁add ( PersonnelBean ▁p ) ▁throw s ▁ FormValidat ionException , ▁iTrustException ▁{ ▁new ▁Add Personnel Validator (). validate ( p ); ▁long ▁newMID ▁= ▁personnelDAO . addEmpty Personnel ( Role . PHA ); ▁p . set MID ( newMID ); ▁personnelDAO . editPersonnel ( p ); ▁String ▁pwd ▁= ▁authDAO . add User ( newMID , ▁Role . PHA , ▁RandomPassword . get RandomPassword ()); ▁p . setPassword ( pwd ); ▁// transDAO . log Transaction ( TransactionType . CRE ATE _ DISABLE _ PATIENT _ HCP , ▁loggedInMID ); ▁transDAO . log Transaction ( TransactionType . CRE ATE _ DISABLE _ PHA , ▁loggedInMID , ▁newMID , ▁" Added ▁New ▁PHA "); ▁return ▁newMID ; ▁} ▁}