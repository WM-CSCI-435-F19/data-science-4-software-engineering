▁ REQUIRE MENT ▁ 46: ▁ SERVER - SIDE ▁ KEY ▁GENERATION ▁ RESPONSE ▁If ▁the ▁request ▁is ▁successful , ▁the ▁server ▁response ▁MUST ▁have ▁an ▁HTTP ▁200 ▁response ▁code ▁with ▁a ▁content - type ▁of ▁" multip art / mixed " ▁consist ing ▁of ▁two ▁parts : ▁one ▁part ▁is ▁the ▁private ▁key ▁data ▁and ▁the ▁other ▁part ▁is ▁the ▁certificate ▁data . ▁The ▁format ▁in ▁which ▁the ▁private ▁key ▁data ▁part ▁is ▁returned ▁is ▁depend ent ▁on ▁whether ▁the ▁private ▁key ▁is ▁being ▁returned ▁with ▁a dditional ▁encryption ▁on ▁to p ▁of ▁that ▁provided ▁by ▁TLS . ▁If ▁a dditional ▁encryption ▁is ▁not ▁being ▁employed , ▁the ▁private ▁key ▁data ▁MUST ▁be ▁placed ▁in ▁an ▁" application / pkcs 8 " . ▁An ▁" application / pkcs 8 " ▁part ▁consist s ▁of ▁the ▁base 64 - encoded ▁DER - encoded ▁[ X .690 ] ▁Private KeyInfo ▁with ▁a ▁Content - Transfer - Encoding ▁of ▁" base 64" ▁[ RFC 2045]. ▁If ▁a dditional ▁encryption ▁is ▁being ▁employed , ▁the ▁private ▁key ▁is ▁placed ▁in side ▁of ▁a ▁CMS ▁SignedData . ▁The ▁SignedData ▁is ▁signed ▁by ▁the ▁party ▁that ▁ generated ▁the ▁private ▁key , ▁which ▁ma y ▁or ▁ma y ▁not ▁be ▁the ▁EST ▁server ▁or ▁the ▁EST ▁CA . ▁The ▁SignedData ▁is ▁f ur ther ▁ protected ▁by ▁plac ing ▁it ▁in side ▁of ▁a ▁CMS ▁EnvelopedData , ▁as ▁describe d ▁in ▁Section ▁4 ▁of ▁[ RFC 5958] . ▁The ▁following ▁list ▁show s ▁how ▁the ▁Encrypted Data ▁is ▁used , ▁depend ing ▁on ▁the ▁type ▁of ▁protection ▁key ▁specified ▁by ▁the ▁client . ▁If ▁the ▁client ▁specified ▁a ▁ symmetric ▁encryption ▁key ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁the ▁secret ▁key ▁identifie d ▁in ▁the ▁request . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁key - encryption ▁ kek ri ▁key ▁manage ment ▁ tech nique . ▁The ▁values ▁are ▁as ▁follow s : ▁version ▁is ▁set ▁to ▁4 , ▁key - encryption ▁key ▁identifier ▁( kek id ) ▁is ▁set ▁to ▁the ▁value ▁of ▁the ▁ DecryptKeyI dentifier ▁from ▁Section ▁4.4.1. 1 ; ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁a c compa ny ing ▁the ▁request ; ▁and ▁encrypted Key ▁is ▁the ▁encrypted ▁key . ▁If ▁the ▁client ▁specified ▁an ▁asymmetric ▁encryption ▁key ▁suit able ▁for ▁key ▁transport ▁operations ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁a ▁random ly ▁ generated ▁ symmetric ▁encryption ▁key . ▁The ▁c ryptograph ic ▁strength ▁of ▁the ▁ symmetric ▁encryption ▁key ▁SHOULD ▁be ▁equ ival ent ▁to ▁the ▁client - ▁specified ▁asymmetric ▁key . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁Key Trans RecipientInfo ▁( k tri ) ▁key ▁manage ment ▁ tech nique . ▁In ▁Key Trans RecipientInfo , ▁the ▁RecipientI dentifier ▁( rid ) ▁is ▁ ei ther ▁the ▁subject Key Identifier ▁copied ▁from ▁the ▁attribute ▁defined ▁in ▁Section ▁4.4.1. 2 ▁or ▁the ▁server ▁determine s ▁an ▁a ssociat ed ▁issue r And S erialNumber ▁from ▁the ▁attribute ; ▁version ▁is ▁derive d ▁from ▁the ▁cho ic e ▁of ▁ri d ▁[ RFC 5652] , ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁a c compa ny ing ▁the ▁request , ▁and ▁encrypted Key ▁is ▁the ▁encrypted ▁key . ▁If ▁the ▁client ▁specified ▁an ▁asymmetric ▁encryption ▁key ▁suit able ▁for ▁key ▁a g re ement ▁operations ▁to ▁protect ▁the ▁server - generated ▁private ▁key , ▁the ▁EnvelopedData ▁content ▁is ▁encrypted ▁using ▁a ▁random ly ▁ generated ▁ symmetric ▁encryption ▁key . ▁The ▁c ryptograph ic ▁strength ▁of ▁the ▁ symmetric ▁encryption ▁key ▁SHOULD ▁be ▁equ ival ent ▁to ▁the ▁client - ▁specified ▁asymmetric ▁key . ▁The ▁EnvelopedData ▁ RecipientInfo ▁field ▁MUST ▁indicate ▁the ▁Key Agree RecipientInfo ▁( ka ri ) ▁key ▁manage ment ▁ tech nique . ▁In ▁the ▁Key Agree RecipientInfo ▁type , ▁version , ▁origina tor , ▁and ▁user ▁key ing ▁mat erial ▁( u km ) ▁are ▁as ▁in ▁[ RFC 5652] , ▁and ▁key Encryption Algorithm ▁is ▁set ▁to ▁one ▁of ▁the ▁key ▁wrap ▁algorithm s ▁that ▁the ▁client ▁included ▁in ▁the ▁S MIME C apabilities ▁a c compa ny ing ▁the ▁request . ▁The ▁r ecipient ' s ▁key ▁identifier ▁is ▁ ei ther ▁copied ▁from ▁the ▁attribute ▁defined ▁in ▁Section ▁4.4.1. 2 ▁to ▁subject Key Identifier ▁or ▁the ▁server ▁determine s ▁an ▁Issuer And S erialNumber ▁that ▁correspond s ▁to ▁the ▁value ▁provided ▁in ▁the ▁attribute . ▁In ▁all ▁th ree ▁a dditional ▁encryption ▁cases , ▁the ▁EnvelopedData ▁is ▁returned ▁in ▁the ▁response ▁as ▁an ▁" application / pkcs 7- mime " ▁part ▁with ▁an ▁s mime - type ▁parameter ▁of ▁" server - generated - key " ▁and ▁a ▁Content - ▁Transfer - Encoding ▁of ▁" base 64" . ▁The ▁certificate ▁data ▁part ▁is ▁an ▁" application / pkcs 7- mime " ▁and ▁exact ly ▁matches ▁the ▁certificate ▁response ▁to ▁/ simpleenroll . ▁When ▁reject ing ▁a ▁request , ▁the ▁server ▁MUST ▁specif y ▁ ei ther ▁an ▁HTTP ▁4 xx ▁error ▁or ▁an ▁HTTP ▁ 5 xx ▁error . ▁If ▁the ▁content - type ▁is ▁not ▁set , ▁the ▁response ▁data ▁MUST ▁be ▁a ▁ plain text ▁human - readable ▁error ▁message .