▁ ï»¿ p ackage ▁unisa . gps . etour . control . Gestione PuntiDiRistoro ; ▁import ▁java . rmi . RemoteException ; ▁import ▁java . sql . SQLException ; ▁import ▁java . util . ArrayList ; ▁import ▁java . util . HashMap ; ▁import ▁java . util . Iterator ; ▁import ▁unisa . gps . etour . bean . BeanConvenzione ; ▁import ▁unisa . gps . etour . bean . Bean PuntoDiRistoro ; ▁import ▁unisa . gps . etour . bean . BeanTag ; ▁import ▁unisa . gps . etour . bean . BeanTurista ; ▁import ▁unisa . gps . etour . bean . BeanVisitaPR ; ▁/ ▁* ▁* ▁TEST ▁C ASE ▁import ▁* ▁Uni s a . gps . etour . control . Gestione PuntiDiRistoro . test . stub . DBConvenzione ; ▁* ▁Import ▁unisa . gps . etour . control . Gestione PuntiDiRistoro . test . stub . DBTurista ; ▁* ▁/ ▁import ▁unisa . gps . etour . repository . DBConvenzione ; ▁import ▁unisa . gps . etour . repository . DBTurista ; ▁import ▁unisa . gps . etour . repository . IDBConvenzione ; ▁import ▁unisa . gps . etour . util . MessaggiErrore ; ▁/ ▁** ▁* ▁Class ▁contentente ▁methods ▁for ▁managing ▁Refreshments ▁by ▁* ▁Operator ▁Agency ▁* ▁* ▁@ ▁Auth or ▁J os eph ▁Mo relli ▁* ▁@ ▁Version ▁0.1 ▁ Â© ▁ 2007 ▁eTour ▁Pro ject ▁- ▁C opy right ▁by ▁DMI ▁SE ▁@ ▁ SA ▁Lab ▁-- ▁* ▁University ▁of ▁Salerno ▁* ▁/ ▁p ublic ▁class ▁Gestione PuntiDiRistoro Agenzia ▁ext ends ▁Gestione PuntiDiRistoro Comune ▁implements ▁IGestione PuntiDiRistoro Agenzia ▁( ▁priv ate ▁static ▁final ▁long ▁s erial Version UID ▁= ▁1 L ; ▁/ ▁/ ▁Constructor ▁p ublic ▁Gestione PuntiDiRistoro Agenzia ▁() ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Call ▁the ▁constructor ▁of ▁the ▁in herit ed ▁class ▁to ▁instantiate ▁/ ▁/ ▁Database ▁connections ▁super ▁(); ▁dbTurista ▁= ▁new ▁ DBTurista ▁(); ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁the ▁operator ▁to ▁cancel ▁an ▁agency ▁point ▁of ▁/ ▁/ ▁Refreshment ▁/ ▁/ ▁Pass ing ▁as ▁parameter ▁the ▁ID ▁of ▁the ▁same ▁Refreshment ▁p ublic ▁boolean ▁cancella PuntoDiRistoro ▁( int ▁p PuntoDiRistoroID ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁identifier ▁if ▁( p PuntoDiRistoroID ▁<0) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁TR Y ▁( ▁/ ▁/ ▁Execut e ▁the ▁method ▁that ▁clear s ▁the ▁Refreshment ▁from ▁the ▁Database ▁/ ▁/ ▁And ▁in ▁case ▁of ▁operation ▁successful ▁return ▁true ▁if ▁( puntoRistoro . cancella PuntoDiRistoro ▁( p PuntoDiRistoroID )) ▁return ▁true ; ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancella PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancella PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁no ▁operations ▁ were ▁successful ▁return ▁false ▁end ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁the ▁operator ▁to ▁include ▁in ▁the ▁Agency ▁database ▁/ ▁/ ▁The ▁new ▁Refreshment ▁with ▁the ▁information ▁contain ed ▁in ▁the ▁bean ▁p ublic ▁boolean ▁inserisci PuntoDiRistoro ▁( Bean PuntoDiRistoro ▁pPuntoDiRistoro ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁of ▁the ▁bean ▁as ▁a ▁parameter ▁and ▁if ▁/ ▁/ ▁Trigger s ▁except ▁remote ▁if ▁( ( pPuntoDiRistoro ▁== ▁null ) ▁| ▁| ▁(! ▁( PPuntoDiRistoro ▁instance of ▁Bean PuntoDiRistoro ))) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁TR Y ▁( ▁/ ▁/ ▁Call ing ▁the ▁method ▁of ▁the ▁class ▁that ▁operat es ▁on ▁the ▁database ▁/ ▁/ ▁Insert ▁the ▁new ▁Refreshment ▁if ▁( puntoRistoro . inserisci PuntoDiRistoro ▁( pPuntoDiRistoro )) ▁/ ▁/ ▁In ▁the ▁case ▁whe re ▁the ▁operations ▁ were ▁successful ▁end ▁/ ▁/ ▁Return s ▁true ▁return ▁true ; ▁) ▁/ ▁/ ▁Exception ▁in ▁database ▁operations ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisci PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisci PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁the ▁operation ▁is ▁not ▁successful ▁return ▁false ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁for ▁obtain ing ▁an ▁ArrayList ▁with ▁all ▁the ▁points ▁Bean ▁/ ▁/ ▁Refreshments ▁< Bean PuntoDiRistoro > ▁ottieni PuntiDiRistoro ▁p ublic ▁ArrayList ▁() ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁ArrayList ▁to ▁return ▁to ▁the ▁end ▁of ▁the ▁method ▁ArrayList ▁< Bean PuntoDiRistoro > ▁toReturn ▁= ▁null ; ▁TR Y ▁( ▁/ ▁/ ▁Get ▁the ▁list ▁of ▁Refreshments ▁through ▁the ▁class ▁/ ▁/ ▁Connect ▁to ▁database ▁/ ▁/ ▁And ▁save ▁the ▁list ▁it self ▁nell ' ArrayList ▁toReturn ▁= ▁puntoRistoro . ottieniLista PR ▁(); ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Check ▁the ▁ArrayList ▁to ▁return ▁so ▁as ▁not ▁to ▁pass ▁null ▁values ▁/ ▁/ ▁To ▁the ▁caller ▁if ▁( null ▁== ▁toReturn ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁/ ▁/ ▁Return ▁the ▁ArrayList ▁with ▁all ▁the ▁refreshment ▁toReturn ▁return ; ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁you ▁to ▁get ▁all ▁the ▁refreshment ▁that ▁have ▁/ ▁/ ▁A ▁Convention ▁on ▁or ▁off ▁de pend ing ▁on ▁the ▁parameter ▁passed ▁p ublic ▁ArrayList ▁< Bean PuntoDiRistoro > ▁ottieni PuntiDiRistoro ▁( ▁ statoConvenzione ▁boolean ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Array ▁that ▁allow s ▁me ▁to ▁store ▁all ▁the ▁refreshment ▁and ▁/ ▁/ ▁W hich ▁will ▁remove ▁/ ▁/ ▁De pend ing ▁on ▁the ▁parameter ▁passed ▁to ▁the ▁refreshment ▁active ▁or ▁not ▁ArrayList ▁< Bean PuntoDiRistoro > ▁toReturn ▁= ▁null ; ▁/ ▁/ ▁Array ▁that ▁allow s ▁me ▁to ▁store ▁all ▁the ▁refreshment ▁active ▁/ ▁/ ▁Us ing ▁the ▁database ▁connection ▁ArrayList ▁< Bean PuntoDiRistoro > ▁active ▁= ▁null ; ▁/ ▁/ ▁ Instance ▁to ▁connect ▁to ▁the ▁database ▁IDBConvenzione ▁conv ▁= ▁new ▁ DBConvenzione ▁(); ▁TR Y ▁( ▁/ ▁/ ▁Connect ▁all ▁proceed s ▁from ▁the ▁refreshment ▁As set s ▁conv . ottieniLista Convenzione Attiva PR ▁assets ▁= ▁(); ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro ▁( boolean )" ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro ▁( boolean )" ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁you ▁want ▁to ▁get ▁the ▁refreshment ▁active , ▁then ▁return ▁/ ▁/ ▁Di re ct ly ▁to ▁th ose ▁passed ▁by ▁the ▁connection ▁to ▁the ▁database ▁if ▁( statoConvenzione ) ▁( ▁/ ▁/ ▁Check ▁the ▁content s ▁dell ' ArrayList ▁so ▁as ▁not ▁to ▁return ▁/ ▁/ ▁ Null ▁values ▁to ▁the ▁caller ▁if ▁( active ▁== ▁null ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁return ▁active ; ▁) ▁else ▁( ▁TR Y ▁( ▁/ ▁/ ▁Connect ▁all ▁proceed s ▁from ▁the ▁refreshment ▁then ▁/ ▁/ ▁Perform ▁compari s on s ▁toReturn ▁= ▁puntoRistoro . ottieniLista PR ▁(); ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro ▁( boolean )" ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntiDiRistoro ▁( boolean )" ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁ Size ▁dell ' ArrayList ▁containing ▁all ▁of ▁go ur met ▁/ ▁/ ▁Co ul d ▁/ ▁/ ▁Change ▁ size ▁if ▁you ▁remove ▁some ▁element ▁int ▁di m ▁= ▁toReturn . size ▁(); ▁/ ▁/ ▁Variable ▁that ▁allow s ▁me ▁to ▁under st and ▁whether ▁to ▁remove ▁a ▁Point ▁/ ▁/ ▁Refreshments ▁/ ▁/ ▁ From ▁array ▁that ▁then ▁I ▁must ▁return ▁boolean ▁present ▁= ▁false ; ▁/ ▁/ ▁ First ▁loop ▁to ▁loop ▁through ▁all ▁the ▁ArrayList ▁elements ▁of ▁/ ▁/ ▁All ▁Refreshments ▁for ▁( int ▁i ▁= ▁0; ▁i ▁< dim ; ▁i ▁+ ▁+) ▁( ▁/ ▁/ ▁ Second ▁loop ▁to ▁loop ▁through ▁all ▁the ▁ArrayList ▁elements ▁/ ▁/ ▁Con es ▁just ▁Refreshments ▁active ▁for ▁( int ▁j ▁= ▁0 ▁j ▁< attivi . size ▁() ▁j ▁+ ▁+) ▁( ▁/ ▁/ ▁I f ▁the ▁ca tering ▁points ▁in ▁question ▁has ▁the ▁ID ▁equal ▁to ▁one ▁/ ▁/ ▁Of ▁th ose ▁assets , ▁then ▁set ▁this ▁to ▁true ▁if ▁( attivi . get ▁( j ) . ▁getId ▁() ▁== ▁toReturn . get ▁( i ) . ▁getId ▁()) ▁present ▁= ▁true ; ▁) ▁/ ▁/ ▁I f ▁the ▁ca tering ▁points ▁in ▁question ▁has ▁a ▁Convention ▁active ▁/ ▁/ ▁Remove s ▁it ▁from ▁th ose ▁to ▁be ▁returned ▁if ▁( present ) ▁toReturn . remove ▁( i ); ▁) ▁) ▁/ ▁/ ▁Return ▁the ▁ArrayList ▁obtained ▁toReturn ▁return ; ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁you ▁to ▁change ▁the ▁past ▁as ▁a ▁refreshment ▁/ ▁/ ▁Parameter ▁p ublic ▁boolean ▁modifica PuntoDiRistoro ▁( ▁Bean PuntoDiRistoro ▁pPuntoDiRistoro Aggiornato ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁of ▁the ▁bean ▁as ▁a ▁parameter ▁and ▁if ▁/ ▁/ ▁Trigger ▁an ▁exception ▁remote ▁if ▁( null ▁== ▁pPuntoDiRistoro Aggiornato ▁| ▁| ▁(! ▁( PPuntoDiRistoro Aggiornato ▁instance of ▁Bean PuntoDiRistoro ))) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁TR Y ▁( ▁/ ▁/ ▁Call ▁the ▁method ▁to ▁change ▁the ▁database ▁connection ▁/ ▁/ ▁The ▁Refreshment ▁if ▁( puntoRistoro . modifica PuntoDiRistoro ▁( pPuntoDiRistoro Aggiornato )) ▁/ ▁/ ▁Return ▁a ▁positive ▁value ▁if ▁the ▁operation ▁was ▁successful ▁/ ▁/ ▁End ▁return ▁true ; ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁modifica PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁modifica PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Return ▁false ▁if ▁the ▁operation ▁is ▁successful ▁you ▁should ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁to ▁obtain ▁the ▁Bean ▁a ▁particular ▁point ▁/ ▁/ ▁Refreshment ▁whose ▁/ ▁/ ▁Identifie r ▁is ▁passed ▁as ▁parameter ▁p ublic ▁Bean PuntoDiRistoro ▁ottieni PuntoDiRistoro ▁( int ▁p PuntoDiRistoroID ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁identifier ▁if ▁( p PuntoDiRistoroID ▁<0) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁/ ▁/ ▁Bean ▁to ▁return ▁to ▁the ▁caller ▁Bean PuntoDiRistoro ▁toReturn ▁= ▁null ; ▁TR Y ▁( ▁/ ▁/ ▁Re venue ▁ca tering ▁points ▁in ▁the ▁issue ▁by ▁connect ing ▁to ▁/ ▁/ ▁Database ▁toReturn ▁= ▁puntoRistoro . ottieni PuntoDiRistoro ▁( p PuntoDiRistoroID ); ▁) ▁/ ▁/ ▁Exception ▁in ▁the ▁database ▁ ope ar azioni ▁ catch ▁( SQLException ▁e ) ▁( ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁ca used ▁by ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁ottieni PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Check ▁the ▁bean ▁to ▁be ▁returned ▁in ▁order ▁not ▁to ▁return ▁null ▁values ▁/ ▁/ ▁To ▁the ▁caller ▁if ▁( null ▁== ▁toReturn ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁/ ▁/ ▁Return ▁the ▁bean ▁of ▁Refreshment ▁toReturn ▁return ; ▁) ▁/ ▁/ ▁Method ▁that ▁allow s ▁you ▁to ▁activate ▁a ▁particular ▁convention ▁to ▁a ▁Point ▁/ ▁/ ▁Pass ed ▁as ▁parameter ▁Refreshments ▁p ublic ▁boolean ▁a ttivaConvenzione ▁( int ▁p PuntoDiRistoroID , ▁BeanConvenzione ▁pConv ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁of ▁parameters ▁passed ▁if ▁( ( p PuntoDiRistoroID ▁<0) ▁| ▁| ▁( pConv ▁== ▁null ) ▁| ▁| ▁(! ▁( PC on v ▁instance of ▁BeanConvenzione ))) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁/ ▁/ ▁Check ▁the ▁data ▁ f ur th er ▁if ▁( pConv . get IdPuntoDiRistoro ▁()! ▁= ▁p PuntoDiRistoroID ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁IDBConvenzione ▁conv ▁= ▁null ; ▁TR Y ▁( ▁/ ▁/ ▁Instantiate ▁the ▁class ▁to ▁connect ▁to ▁the ▁database ▁conv ▁= ▁new ▁ DBConvenzione ▁(); ▁/ ▁/ ▁I f ▁the ▁Convention ▁is ▁not ▁yet ▁active , ▁previously ▁provided ▁to ▁/ ▁/ ▁Activate ▁it ▁loc ally ▁and ▁then ▁pass ▁the ▁bean ▁to ▁the ▁database ▁changed ▁if ▁( conv . ottieni Conve zioneAttiva ▁( p PuntoDiRistoroID ) ▁== ▁null ) ▁( ▁pConv . set Attiva ▁( true ); ▁conv . modifica Convenzione ▁( pConv ); ▁return ▁true ; ▁) ▁) ▁/ ▁/ ▁Exception ▁in ▁operations ▁on ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁ca used ▁by ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁a ttivaConvenzione " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁the ▁operation ▁is ▁successful ▁you ▁should ▁return ▁false ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁that ▁returns ▁a ▁ HashMap ▁containing , ▁for ▁Refreshment ▁/ ▁/ ▁Pass ed ▁as ▁a ▁parameter , ▁the ▁feedback ▁associated ▁with ▁it ▁p ublic ▁ HashMap ▁< BeanVisitaPR , ▁String > ▁ottieniFeedback PuntoDiRistoro ▁( ▁p PuntoDiRistoroID ▁int ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁ID ▁passed ▁as ▁a ▁parameter ▁if ▁( p PuntoDiRistoroID ▁<0) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁/ ▁/ ▁Instantiate ▁the ▁map ▁and ▁the ▁perform ance ▁of ▁ArrayList ▁that ▁I ▁will ▁use ▁/ ▁/ ▁Method ▁ HashMap ▁< BeanVisitaPR , ▁String > ▁mappaRitorno ▁= ▁null ; ▁ArrayList ▁< BeanVisitaPR > ▁bvisita ▁= ▁null ; ▁TR Y ▁( ▁/ ▁/ ▁ Here ▁I ▁take ▁the ▁list ▁of ▁all ▁visits ▁to ▁the ▁PR ▁passed ▁as ▁/ ▁/ ▁Parameter ▁bvisita ▁= ▁feed . ottieni ListaVisitaPR ▁( p PuntoDiRistoroID ); ▁/ ▁/ ▁Instantiate ▁the ▁map ▁of ▁the ▁same ▁ size ▁as ▁the ▁list ▁of ▁/ ▁/ ▁BeanVisitaPR ▁mappaRitorno ▁= ▁new ▁ HashMap ▁< BeanVisitaPR , ▁String > ▁( bvisita . size ▁()); ▁/ ▁/ ▁ Here ▁we ▁be gin ▁to ▁iterate ▁on ▁each ▁visit ▁to ▁add ▁its ▁/ ▁/ ▁Username ▁for ▁( Iterator ▁< BeanVisitaPR > ▁i teratoreVisitaPR ▁= ▁bvisita . iterator ▁(); ▁i teratoreVisitaPR ▁ . ▁ hasNext ▁(); ) ▁( ▁/ ▁/ ▁Recuper to ▁the ▁BeanVisitaPR ▁BeanVisitaPR ▁bVisitaTemp ▁= ▁i teratoreVisitaPR . next ▁(); ▁/ ▁/ ▁Re trieve ▁the ▁tourist ▁who ▁ left ▁the ▁comment ▁that ▁I ▁/ ▁/ ▁E x am ining ▁BeanTurista ▁bTuristaTemp ▁= ▁dbTurista . ottieniTurista ▁( bVisitaTemp ▁ . ▁get IdTurista ▁()); ▁/ ▁/ ▁Get ▁the ▁username ▁of ▁the ▁Tourist ▁String ▁use rnameTuristaTemp ▁= ▁bTuristaTemp . get Username ▁(); ▁/ ▁/ ▁P ut ▁the ▁p a ir ▁in ▁the ▁map ▁mappaRitorno . put ▁( bVisitaTemp , ▁use rnameTuristaTemp ); ▁) ▁) ▁/ ▁/ ▁Exception ▁in ▁database ▁operations ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁o ttieniFeedbackPR " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exceptions ▁ca used ▁by ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁o ttieniFeedbackPR " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Check ▁the ▁return ▁parameter ▁so ▁as ▁not ▁to ▁pass ▁null ▁values ▁/ ▁/ ▁To ▁the ▁database ▁if ▁( null ▁== ▁mappaRitorno ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ FORMAT O _ BEAN ); ▁mappaRitorno ▁return ; ▁) ▁/ ▁/ ▁Method ▁to ▁insert ▁a ▁tag ▁from ▁th ose ▁of ▁a ▁refreshment ▁p ublic ▁boolean ▁cancellaTag PuntoDiRistoro ▁( p PuntoDiRistoroId ▁int , ▁int ▁pTagId ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁the ▁validit y ▁of ▁past ▁data ▁if ▁( ( p PuntoDiRistoroId ▁<0) ▁| ▁| ▁( pTagId ▁<0) ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁/ ▁/ ▁ArrayList ▁which ▁store s ▁all ▁the ▁tags ▁ArrayList ▁< BeanTag > ▁tags ; ▁/ ▁/ ▁Boolean ▁variable ▁to ▁check ▁if ▁the ▁Refreshment ▁/ ▁/ ▁H old s ▁the ▁tag ▁you ▁want ▁to ▁delete ▁boolean ▁present ▁= ▁false ; ▁TR Y ▁( ▁/ ▁/ ▁Use ▁the ▁method ▁through ▁the ▁class ▁of ▁database ▁connection ▁tags ▁= ▁tag . ottieniTag PuntoDiRistoro ▁( p PuntoDiRistoroId ); ▁) ▁/ ▁/ ▁Exception ▁in ▁the ▁execut ion ▁of ▁transaction s ▁in ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancellaTag PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exception ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancellaTag PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁Check ▁if ▁the ▁tag ▁is ▁present ▁cycl e ▁currently ▁/ ▁/ ▁ Between ▁th ose ▁of ▁Refreshment ▁for ▁( t ▁BeanTag : ▁tags ) ▁if ▁( t . getId ▁() ▁== ▁pTagId ) ▁present ▁= ▁true ; ▁/ ▁/ ▁I f ▁the ▁tag ▁is ▁present ▁ am ong ▁th ose ▁of ▁eateries , ▁then ▁/ ▁/ ▁Provide s ▁for ▁execut ing ▁the ▁erase ▁operation ▁if ▁( present ) ▁( ▁TR Y ▁( ▁return ▁tag . cancellaTag PuntoDiRistoro ▁( p PuntoDiRistoroId , ▁pTagId ); ▁) ▁/ ▁/ ▁Exception ▁in ▁implement ing ▁the ▁operation ▁on ▁the ▁database ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancellaTag PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁/ ▁/ ▁U nexpected ▁exception ▁due ▁to ▁other ▁fa ctors ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁cancellaTag PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁) ▁/ ▁/ ▁In ▁case ▁some th ing ▁di d ▁not ▁come ▁to ▁ f ru i tion ▁/ ▁/ ▁Return ▁false ▁return ▁false ; ▁) ▁/ ▁/ ▁Method ▁to ▁delete ▁a ▁tag ▁from ▁th ose ▁of ▁a ▁refreshment ▁/ ▁/ ▁The ▁operations ▁are ▁id ent ical ▁to ▁th ose ▁above , ▁except ▁for ▁/ ▁/ ▁Control ▁ over ▁the ▁presen ce ▁of ▁the ▁tag ▁from ▁th ose ▁of ▁Refreshment ▁/ ▁/ ▁W hich ▁should ▁ give ▁ne g ative ▁results , ▁and ▁the ▁call ▁ here ▁is ▁the ▁method ▁of ▁/ ▁/ ▁Insert ▁p ublic ▁boolean ▁inserisciTag PuntoDiRistoro ▁( p PuntoDiRistoroId ▁int , ▁int ▁pTagId ) ▁throws ▁RemoteException ▁( ▁if ▁( ( p PuntoDiRistoroId ▁<0) ▁| ▁| ▁( pTagId ▁<0) ) ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DATI ); ▁ArrayList ▁< BeanTag > ▁tags ; ▁boolean ▁present ▁= ▁false ; ▁TR Y ▁( ▁tags ▁= ▁tag . ottieniTag PuntoDiRistoro ▁( p PuntoDiRistoroId ); ▁) ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisciTag PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisciTag PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁for ▁( t ▁BeanTag : ▁tags ) ▁if ▁( t . getId ▁() ▁== ▁pTagId ) ▁present ▁= ▁true ; ▁/ ▁/ ▁Check ▁that ▁the ▁Refreshment ▁has ▁not ▁al read y ▁specified ▁tag ▁if ▁( present ) ▁( ▁TR Y ▁( ▁/ ▁/ ▁Call ing ▁the ▁method ▁of ▁adding ▁the ▁class ▁via ▁/ ▁/ ▁Connect ▁to ▁database ▁return ▁tag . aggiungeTag PuntoDiRistoro ▁( p PuntoDiRistoroId , ▁pTagId ); ▁) ▁ catch ▁( SQLException ▁e ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisciTag PuntoDiRistoro " ▁+ ▁E . toString ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ DBMS ); ▁) ▁ catch ▁( Exception ▁ee ) ▁( ▁System . out ▁ . ▁System . out . println ▁( ▁" Error ▁in ▁method ▁inserisciTag PuntoDiRistoro " ▁E e . toString ▁+ ▁()); ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁) ▁/ ▁/ ▁Return ▁false ▁if ▁some ▁operation ▁is ▁not ▁successful ▁you ▁should ▁return ▁false ; ▁) ▁)