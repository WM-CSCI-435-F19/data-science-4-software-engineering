▁ ï»¿ p ackage ▁unisa . gps . etour . control . Gestione UtentiRegistrati ; ▁import ▁java . rmi . RemoteException ; ▁import ▁java . rmi . server . Uni castRemoteObject ; ▁import ▁java . sql . SQLException ; ▁import ▁unisa . gps . etour . bean . BeanTurista ; ▁import ▁unisa . gps . etour . repository . DBTurista ; ▁import ▁unisa . gps . etour . util . ControlloDati ; ▁import ▁unisa . gps . etour . util . MessaggiErrore ; ▁p ublic ▁class ▁A uthenticat ion ▁ext ends ▁Uni castRemoteObject ▁implements ▁I A utenticazione ▁( ▁priv ate ▁static ▁final ▁long ▁s erial Version UID ▁= ▁0 L ; ▁p ublic ▁A uthenticat ion ▁() ▁throws ▁RemoteException ▁( ▁super ▁(); ▁) ▁/ ▁/ ▁Object s ▁to ▁man ipula te ▁data ▁Turista ▁Pr ivate ▁ DBTurista ▁tourist ▁ DBTurista ▁= ▁new ▁(); ▁Pr ivate ▁BeanTurista ▁bTurista ; ▁p ublic ▁int ▁login ▁( String ▁pUsername , ▁String ▁pPassword , ▁byte ▁ pTipologiaUtente ) ▁throws ▁RemoteException ▁( ▁/ ▁/ ▁Check ▁if ▁the ▁string ▁username ▁and ▁password ▁if ▁( ControlloDati . controlla Stringa ▁( pUsername , ▁true , ▁true , ▁"_-", ▁null , ▁ 6, ▁12) ▁& ▁& ▁ControlloDati . controlla Stringa ▁( pPassword , ▁true , ▁true , ▁"_-", ▁null , ▁ 5, ▁12)) ▁TR Y ▁( ▁s witch ▁( pTipologiaUtente ) ▁( ▁/ ▁/ ▁I f ▁the ▁type ▁is ▁Turista ▁ VISIT OR S ▁homes : ▁/ ▁/ ▁ Invoke ▁the ▁method ▁to ▁obtain ▁the ▁Bean ▁del ▁Turista ▁/ ▁/ ▁G iven ▁the ▁username ▁bTurista ▁= ▁turista . ottieniTurista ▁( pUsername ); ▁/ ▁/ ▁Check ▁that ▁the ▁Bean ▁is ▁not ▁null ▁and ▁/ ▁/ ▁Password s ▁match ▁if ▁( b Turista ▁= ▁null ▁B Turista . getPassword ▁& ▁& ▁() . ▁Equal s ▁( pPassword )) ▁bTurista . getId ▁return ▁(); ▁/ ▁/ ▁I f ▁the ▁type ▁and ▁eateries ▁homes ▁OP _ PUNTO _ DI _ RISTORO : ▁/ ▁/ ▁Not ▁implement ed ▁was ▁the ▁operation al ▁point ▁of ▁/ ▁/ ▁Refreshment ▁return ▁ -1; ▁/ ▁/ ▁I f ▁not ▁match ▁any ▁know n ▁type ▁default : ▁return ▁ -1; ▁) ▁) ▁ catch ▁( SQLException ▁e ) ▁( ▁throw ▁new ▁RemoteException ▁( ▁ MessaggiErrore . ERRORE _ DBMS ); ▁) ▁ catch ▁( Exception ▁e ) ▁( ▁throw ▁new ▁RemoteException ▁( MessaggiErrore . ERRORE _ SCONOSCIUTO ); ▁) ▁/ ▁/ ▁I f ▁the ▁data ▁are ▁incorrect ▁returns ▁-1 ▁return ▁ -1; ▁) ▁)